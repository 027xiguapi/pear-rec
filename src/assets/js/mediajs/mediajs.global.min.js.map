{"mappings":"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","sources":["src/eventTarget.ts","src/soundMeter.ts","node_modules/@swc/helpers/src/_define_property.mjs","node_modules/@swc/helpers/src/_type_of.mjs","node_modules/webrtc-adapter/src/js/utils.js","node_modules/@swc/helpers/src/_array_with_holes.mjs","node_modules/@swc/helpers/src/_iterable_to_array.mjs","node_modules/@swc/helpers/src/_non_iterable_rest.mjs","node_modules/@swc/helpers/src/_array_like_to_array.mjs","node_modules/@swc/helpers/src/_unsupported_iterable_to_array.mjs","node_modules/@swc/helpers/src/_sliced_to_array.mjs","node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","node_modules/@swc/helpers/src/_array_without_holes.mjs","node_modules/@swc/helpers/src/_non_iterable_spread.mjs","node_modules/@swc/helpers/src/_to_consumable_array.mjs","node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","node_modules/webrtc-adapter/src/js/safari/safari_shim.js","node_modules/sdp/sdp.js","node_modules/webrtc-adapter/src/js/common_shim.js","node_modules/webrtc-adapter/src/js/adapter_core.js","src/env.ts","src/media.ts","node_modules/webrtc-adapter/src/js/adapter_factory.js","src/exports.ts","package.json","src/global.ts"],"sourcesContent":["type EventType =\r\n\t| \"error\"\r\n\t| \"create\"\r\n\t| \"destroy\"\r\n\t| \"start\"\r\n\t| \"stop\"\r\n\t| \"pause\"\r\n\t| \"resume\"\r\n\t| \"dataavailable\";\r\n\r\nclass EventTarget {\r\n\tprivate eventBus: Record<EventType, Function[]> = {\r\n\t\terror: [],\r\n\t\tcreate: [],\r\n\t\tdestroy: [],\r\n\t\tstart: [],\r\n\t\tstop: [],\r\n\t\tpause: [],\r\n\t\tresume: [],\r\n\t\tdataavailable: [],\r\n\t};\r\n\r\n\t// \r\n\ton(name: EventType, callback: Function) {\r\n\t\tconst callbackList: Array<Function> = this.eventBus[name] || [];\r\n\t\tcallbackList.push(callback);\r\n\t\tthis.eventBus[name] = callbackList;\r\n\t}\r\n\r\n\t// \r\n\temit(name: EventType, ...args: Array<any>) {\r\n\t\tconst evnetName = this.eventBus[name];\r\n\t\tif (evnetName) {\r\n\t\t\tevnetName.forEach((fn) => {\r\n\t\t\t\tfn.apply(this, args);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.error(`emit ${name} is not find`);\r\n\t\t}\r\n\t}\r\n\r\n\t// \r\n\toff(name: EventType, fn: Function) {\r\n\t\tconst evnetName = this.eventBus[name];\r\n\t\tif (evnetName && fn) {\r\n\t\t\tconst index = evnetName.findIndex((fns) => fns === fn);\r\n\t\t\tevnetName.splice(index, 1);\r\n\t\t} else {\r\n\t\t\tconsole.error(`off ${name} is not find`);\r\n\t\t}\r\n\t}\r\n\r\n\t// \r\n\tonce(name: EventType, fn: Function) {\r\n\t\tconst decor = (...args: Array<any>) => {\r\n\t\t\tfn.apply(this, args);\r\n\t\t\tthis.off(name, decor);\r\n\t\t};\r\n\t\tthis.on(name, decor);\r\n\t}\r\n}\r\n\r\nexport default EventTarget;\r\n","class SoundMeter {\r\n\tprivate context: AudioContext;\r\n\tprivate instant: number = 0.0;\r\n\tprivate slow: number = 0.0;\r\n\tprivate clip: number = 0.0;\r\n\tprivate script: ScriptProcessorNode;\r\n\tprivate mic: MediaStreamAudioSourceNode;\r\n\r\n\tconstructor(context: AudioContext) {\r\n\t\tthis.context = context;\r\n\t\tthis.script = context.createScriptProcessor(2048, 1, 1);\r\n\t\tthis.script.onaudioprocess = (event) => {\r\n\t\t\tconst input = event.inputBuffer.getChannelData(0);\r\n\t\t\tlet i;\r\n\t\t\tlet sum = 0.0;\r\n\t\t\tlet clipcount = 0;\r\n\t\t\tfor (i = 0; i < input.length; ++i) {\r\n\t\t\t\tsum += input[i] * input[i];\r\n\t\t\t\tif (Math.abs(input[i]) > 0.99) {\r\n\t\t\t\t\tclipcount += 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.instant = Math.sqrt(sum / input.length);\r\n\t\t\tthis.slow = 0.95 * this.slow + 0.05 * this.instant;\r\n\t\t\tthis.clip = clipcount / input.length;\r\n\t\t};\r\n\t}\r\n\r\n\tgetInstant() {\r\n\t\treturn this.instant;\r\n\t}\r\n\r\n\tgetSlow() {\r\n\t\treturn this.slow;\r\n\t}\r\n\r\n\tgetClip() {\r\n\t\treturn this.clip;\r\n\t}\r\n\r\n\tconnectToSource(stream: MediaStream) {\r\n\t\ttry {\r\n\t\t\tthis.mic = this.context.createMediaStreamSource(stream);\r\n\t\t\tthis.mic.connect(this.script);\r\n\t\t\tthis.script.connect(this.context.destination);\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(e);\r\n\t\t}\r\n\t}\r\n\r\n\tstop() {\r\n\t\tthis.mic.disconnect();\r\n\t\tthis.script.disconnect();\r\n\t}\r\n}\r\n\r\nexport { SoundMeter };\r\n\r\nexport default SoundMeter;\r\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n","export default function _typeof(obj) {\n    \"@swc/helpers - typeof\";\n    return obj && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n    'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n      /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n      /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n      /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\n","import _arrayLikeToArray from './_array_like_to_array.mjs';\n\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))\n    return _arrayLikeToArray(o, minLen);\n}\n","import arrayWithHoles from './_array_with_holes.mjs';\nimport iterableToArrayLimit from './_iterable_to_array.mjs';\nimport nonIterableRest from './_non_iterable_rest.mjs';\nimport unsupportedIterableToArray from './_unsupported_iterable_to_array.mjs';\n\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n            .then(devices => {\n              devices = devices.filter(d => d.kind === 'videoinput');\n              let dev = devices.find(d => matches.some(match =>\n                d.label.toLowerCase().includes(match)));\n              if (!dev && devices.length && matches.includes('back')) {\n                dev = devices[devices.length - 1]; // more likely the back cam\n              }\n              if (dev) {\n                constraints.video.deviceId = face.exact\n                  ? {exact: dev.deviceId}\n                  : {ideal: dev.deviceId};\n              }\n              constraints.video = constraintsToChrome_(constraints.video);\n              logging('chrome: ' + JSON.stringify(constraints));\n              return func(constraints);\n            });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n    .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n        this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n        externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n        internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n        .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n    window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n    'localDescription', {\n      get() {\n        const description = origLocalDescription.get.apply(this);\n        if (description.type === '') {\n          return description;\n        }\n        return replaceInternalStreamId(this, description);\n      }\n    });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n          'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","import _arrayLikeToArray from './_array_like_to_array.mjs';\n\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n","import arrayWithoutHoles from './_array_without_holes.mjs';\nimport iterableToArray from './_iterable_to_array.mjs';\nimport nonIterableSpread from './_non_iterable_spread.mjs';\nimport unsupportedIterableToArray from './_unsupported_iterable_to_array.mjs';\n\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n      'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n      Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        // WebIDL input coercion and validation\n        let sendEncodings = arguments[1] && arguments[1].sendEncodings;\n        if (sendEncodings === undefined) {\n          sendEncodings = [];\n        }\n        sendEncodings = [...sendEncodings];\n        const shouldPerformCheck = sendEncodings.length > 0;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = sendEncodings;\n            sender.sendEncodings = sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateOffer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateAnswer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n        .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (server.urls === undefined && server.url) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio', {direction: 'recvonly'});\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video', {direction: 'recvonly'});\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nconst SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substring(2, 12);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(line => line.trim());\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  const parts = blob.split('\\nm=');\n  return parts.map((part, index) => (index > 0 ?\n    'm=' + part : part).trim() + '\\r\\n');\n};\n\n// Returns the session description.\nSDPUtils.getDescription = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// Returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(line => line.indexOf(prefix) === 0);\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\n// Input can be prefixed with a=.\nSDPUtils.parseCandidate = function(line) {\n  let parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  const candidate = {\n    foundation: parts[0],\n    component: {1: 'rtp', 2: 'rtcp'}[parts[1]] || parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7],\n  };\n\n  for (let i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compatibility.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag. Don't overwrite.\n        if (candidate[parts[i]] === undefined) {\n          candidate[parts[i]] = parts[i + 1];\n        }\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\n// This does not include the a= prefix!\nSDPUtils.writeCandidate = function(candidate) {\n  const sdp = [];\n  sdp.push(candidate.foundation);\n\n  const component = candidate.component;\n  if (component === 'rtp') {\n    sdp.push(1);\n  } else if (component === 'rtcp') {\n    sdp.push(2);\n  } else {\n    sdp.push(component);\n  }\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  const type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// Sample input:\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substring(14).split(' ');\n};\n\n// Parses a rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  let parts = line.substring(9).split(' ');\n  const parsed = {\n    payloadType: parseInt(parts.shift(), 10), // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generates a rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  const channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses a extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1],\n    attributes: parts.slice(2).join(' '),\n  };\n};\n\n// Generates an extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri +\n      (headerExtension.attributes ? ' ' + headerExtension.attributes : '') +\n      '\\r\\n';\n};\n\n// Parses a fmtp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  const parsed = {};\n  let kv;\n  const parts = line.substring(line.indexOf(' ') + 1).split(';');\n  for (let j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates a fmtp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  let line = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    const params = [];\n    Object.keys(codec.parameters).forEach(param => {\n      if (codec.parameters[param] !== undefined) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses a rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  const parts = line.substring(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' '),\n  };\n};\n\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  let lines = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(fb => {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses a RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  const sp = line.indexOf(' ');\n  const parts = {\n    ssrc: parseInt(line.substring(7, sp), 10),\n  };\n  const colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substring(sp + 1, colon);\n    parts.value = line.substring(colon + 1);\n  } else {\n    parts.attribute = line.substring(sp + 1);\n  }\n  return parts;\n};\n\n// Parse a ssrc-group line (see RFC 5576). Sample input:\n// a=ssrc-group:semantics 12 34\nSDPUtils.parseSsrcGroup = function(line) {\n  const parts = line.substring(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(ssrc => parseInt(ssrc, 10)),\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// Returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  const mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substring(6);\n  }\n};\n\n// Parses a fingerprint line for DTLS-SRTP.\nSDPUtils.parseFingerprint = function(line) {\n  const parts = line.substring(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1].toUpperCase(), // the definition is upper-case in RFC 4572.\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint),\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  let sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(fp => {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  const parts = keyParams.substring(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES parameters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  const ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  const pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substring(12),\n    password: pwd.substring(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  let sdp = 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n  if (params.iceLite) {\n    sdp += 'a=ice-lite\\r\\n';\n  }\n  return sdp;\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  const description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: [],\n  };\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  description.profile = mline[2];\n  for (let i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    const pt = mline[i];\n    const rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      const codec = SDPUtils.parseRtpMap(rtpmapline);\n      const fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(line => {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  const wildcardRtcpFb = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:* ')\n    .map(SDPUtils.parseRtcpFb);\n  description.codecs.forEach(codec => {\n    wildcardRtcpFb.forEach(fb=> {\n      const duplicate = codec.rtcpFeedback.find(existingFeedback => {\n        return existingFeedback.type === fb.type &&\n          existingFeedback.parameter === fb.parameter;\n      });\n      if (!duplicate) {\n        codec.rtcpFeedback.push(fb);\n      }\n    });\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  let sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' ' + (caps.profile || 'UDP/TLS/RTP/SAVPF') + ' ';\n  sdp += caps.codecs.map(codec => {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(codec => {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  let maxptime = 0;\n  caps.codecs.forEach(codec => {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(extension => {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  const encodingParameters = [];\n  const description = SDPUtils.parseRtpParameters(mediaSection);\n  const hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  const hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  const ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(parts => parts.attribute === 'cname');\n  const primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  let secondarySsrc;\n\n  const flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(line => {\n      const parts = line.substring(17).split(' ');\n      return parts.map(part => parseInt(part, 10));\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(codec => {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      let encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red',\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc,\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  let bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substring(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substring(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(params => {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  const rtcpParameters = {};\n\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  const remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(obj => obj.attribute === 'cname')[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  const rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  const mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\nSDPUtils.writeRtcpParameters = function(rtcpParameters) {\n  let sdp = '';\n  if (rtcpParameters.reducedSize) {\n    sdp += 'a=rtcp-rsize\\r\\n';\n  }\n  if (rtcpParameters.mux) {\n    sdp += 'a=rtcp-mux\\r\\n';\n  }\n  if (rtcpParameters.ssrc !== undefined && rtcpParameters.cname) {\n    sdp += 'a=ssrc:' + rtcpParameters.ssrc +\n      ' cname:' + rtcpParameters.cname + '\\r\\n';\n  }\n  return sdp;\n};\n\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  let parts;\n  const spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substring(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  const planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(msidParts => msidParts.attribute === 'msid');\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  const mline = SDPUtils.parseMLine(mediaSection);\n  const maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  let maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substring(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  const sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substring(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize,\n    };\n  }\n  const sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    const parts = sctpMapLines[0]\n      .substring(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize,\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  let output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n',\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n',\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 22);\n};\n\n// Write boiler plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  let sessionId;\n  const version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  const user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  const lines = SDPUtils.splitLines(mediaSection);\n  for (let i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substring(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  return mline[0].substring(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const parts = lines[0].substring(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' '),\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  const line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  const parts = line.substring(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5],\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  const lines = SDPUtils.splitLines(blob);\n  for (let i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substring(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      const augmentedCandidate = Object.assign(nativeCandidate,\n        parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function toJSON() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment,\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimRTCIceCandidateRelayProtocol(window) {\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'relayProtocol' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      const parsedCandidate = SDPUtils.parseCandidate(e.candidate.candidate);\n      if (parsedCandidate.type === 'relay') {\n        // This is a libwebrtc-specific mapping of local type preference\n        // to relayProtocol.\n        e.candidate.relayProtocol = {\n          0: 'tls',\n          1: 'tcp',\n          2: 'udp',\n        }[parsedCandidate.priority >> 24];\n      }\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substring(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n          this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n          this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n\n// Note: Make sure to call this ahead of APIs that modify\n// setLocalDescription.length\nexport function shimParameterlessSetLocalDescription(window, browserDetails) {\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  if (!nativeSetLocalDescription || nativeSetLocalDescription.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      let desc = arguments[0] || {};\n      if (typeof desc !== 'object' || (desc.type && desc.sdp)) {\n        return nativeSetLocalDescription.apply(this, arguments);\n      }\n      // The remaining steps should technically happen when SLD comes off the\n      // RTCPeerConnection's operations chain (not ahead of going on it), but\n      // this is too difficult to shim. Instead, this shim only covers the\n      // common case where the operations chain is empty. This is imperfect, but\n      // should cover many cases. Rationale: Even if we can't reduce the glare\n      // window to zero on imperfect implementations, there's value in tapping\n      // into the perfect negotiation pattern that several browsers support.\n      desc = {type: desc.type, sdp: desc.sdp};\n      if (!desc.type) {\n        switch (this.signalingState) {\n          case 'stable':\n          case 'have-local-offer':\n          case 'have-remote-pranswer':\n            desc.type = 'offer';\n            break;\n          default:\n            desc.type = 'answer';\n            break;\n        }\n      }\n      if (desc.sdp || (desc.type !== 'offer' && desc.type !== 'answer')) {\n        return nativeSetLocalDescription.apply(this, [desc]);\n      }\n      const func = desc.type === 'offer' ? this.createOffer : this.createAnswer;\n      return func.apply(this)\n        .then(d => nativeSetLocalDescription.apply(this, [d]));\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n","import webRTCAdapter_import from \"webrtc-adapter\";\r\n\r\nconst webRTCAdapter: typeof webRTCAdapter_import =\r\n\t//@ts-ignore\r\n\twebRTCAdapter_import.default || webRTCAdapter_import;\r\n\r\nexport const Env = new (class {\r\n\treadonly isIOS = [\"iPad\", \"iPhone\", \"iPod\"].includes(navigator.platform);\r\n\treadonly supportedBrowsers = [\"firefox\", \"chrome\", \"safari\"];\r\n\r\n\treadonly minFirefoxVersion = 59;\r\n\treadonly minChromeVersion = 72;\r\n\treadonly minSafariVersion = 605;\r\n\r\n\tisAudioContextSupported(): boolean {\r\n\t\treturn typeof AudioContext !== \"undefined\";\r\n\t}\r\n\r\n\tisMediaDevicesSupported(): boolean {\r\n\t\treturn typeof navigator.mediaDevices !== \"undefined\";\r\n\t}\r\n\r\n\tisGetUserMediaSupported(): boolean {\r\n\t\treturn (\r\n\t\t\tthis.isMediaDevicesSupported() &&\r\n\t\t\ttypeof navigator.mediaDevices.getUserMedia !== \"undefined\"\r\n\t\t);\r\n\t}\r\n\r\n\tisMediaRecorderSupported(): boolean {\r\n\t\treturn typeof MediaRecorder !== \"undefined\";\r\n\t}\r\n\r\n\tisAudioWorkletNode(): boolean {\r\n\t\treturn typeof AudioWorkletNode !== \"undefined\";\r\n\t}\r\n\r\n\tisBrowserSupported(): boolean {\r\n\t\tconst browser = this.getBrowser();\r\n\t\tconst version = this.getVersion();\r\n\r\n\t\tconst validBrowser = this.supportedBrowsers.includes(browser);\r\n\r\n\t\tif (!validBrowser) return false;\r\n\r\n\t\tif (browser === \"chrome\") return version >= this.minChromeVersion;\r\n\t\tif (browser === \"firefox\") return version >= this.minFirefoxVersion;\r\n\t\tif (browser === \"safari\")\r\n\t\t\treturn !this.isIOS && version >= this.minSafariVersion;\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetBrowser(): string {\r\n\t\treturn webRTCAdapter.browserDetails.browser;\r\n\t}\r\n\r\n\tgetVersion(): number {\r\n\t\treturn webRTCAdapter.browserDetails.version || 0;\r\n\t}\r\n\r\n\tisUnifiedPlanSupported(): boolean {\r\n\t\tconst browser = this.getBrowser();\r\n\t\tconst version = webRTCAdapter.browserDetails.version || 0;\r\n\r\n\t\tif (browser === \"chrome\" && version < this.minChromeVersion) return false;\r\n\t\tif (browser === \"firefox\" && version >= this.minFirefoxVersion) return true;\r\n\t\tif (\r\n\t\t\t!(\r\n\t\t\t\tthis.isAudioContextSupported() &&\r\n\t\t\t\tthis.isMediaDevicesSupported() &&\r\n\t\t\t\tthis.isGetUserMediaSupported() &&\r\n\t\t\t\tthis.isMediaRecorderSupported() &&\r\n\t\t\t\tthis.isAudioWorkletNode()\r\n\t\t\t)\r\n\t\t)\r\n\t\t\treturn false;\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\ttoString(): string {\r\n\t\treturn `Supports:\r\n    browser:${this.getBrowser()}\r\n    version:${this.getVersion()}\r\n    isIOS:${this.isIOS}\r\n    isAudioContextSupported:${this.isAudioContextSupported()}\r\n\tisMediaDevicesSupported:${this.isMediaDevicesSupported()}\r\n\tisGetUserMediaSupported:${this.isGetUserMediaSupported()}\r\n\tisMediaRecorderSupported:${this.isMediaRecorderSupported()}\r\n    isBrowserSupported:${this.isBrowserSupported()}\r\n\tisAudioWorkletNode:${this.isAudioWorkletNode()}\r\n    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}\r\n\t`;\r\n\t}\r\n})();\r\n","import EventTarget from \"./eventTarget\";\r\nimport SoundMeter from \"./soundMeter\";\r\nimport { Env } from \"./env\";\r\nimport type {\r\n\tMediaType,\r\n\tMediaState,\r\n\tAudioOption,\r\n\tVideoOption,\r\n\tScreenOption,\r\n} from \"./type\";\r\n\r\nclass Media extends EventTarget {\r\n\tprivate mediaStream: MediaStream | null = null;\r\n\r\n\tprivate mediaRecorder: MediaRecorder | null = null;\r\n\r\n\tprivate mediaBlobs: Blob[] = [];\r\n\r\n\tprivate soundMeter: SoundMeter | null = null;\r\n\r\n\tprivate mediaState: MediaState = \"inactive\";\r\n\r\n\tprivate mediaStreamConstraints: MediaStreamConstraints | null = null;\r\n\r\n\tprivate mediaRecorderOptions: MediaRecorderOptions | null = null;\r\n\r\n\tprivate mediaType: MediaType;\r\n\r\n\tprivate timeSlice: number | null = null;\r\n\r\n\tconstructor(\r\n\t\tmediaType: MediaType,\r\n\t\toption?: AudioOption | VideoOption | ScreenOption,\r\n\t) {\r\n\t\tsuper();\r\n\t\tif (Env.isUnifiedPlanSupported()) {\r\n\t\t\tthis.setMediaType(mediaType).setConfig(option);\r\n\t\t} else {\r\n\t\t\tthis.emit(\"error\", { type: \"constructor\", message: `${Env.toString()}` });\r\n\t\t}\r\n\t}\r\n\r\n\tsetConfig(option?: AudioOption | VideoOption | ScreenOption) {\r\n\t\tswitch (this.mediaType) {\r\n\t\t\tcase \"audio\":\r\n\t\t\t\tthis.setAudioConfig(option);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"video\":\r\n\t\t\t\tthis.setVideoConfig(option);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"screen\":\r\n\t\t\t\tthis.setScreenConfig(option);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetAudioConstraints(option) {\r\n\t\tlet { audio, sampleRate, echoCancellation } = option || {};\r\n\r\n\t\tif (\r\n\t\t\ttypeof sampleRate === \"undefined\" &&\r\n\t\t\ttypeof echoCancellation === \"undefined\"\r\n\t\t) {\r\n\t\t\taudio || (audio = true);\r\n\t\t} else {\r\n\t\t\taudio = {};\r\n\t\t\tsampleRate && (audio[\"sampleRate\"] = sampleRate);\r\n\t\t\techoCancellation &&\r\n\t\t\t\t(audio[\"echoCancellation\"] = { exact: echoCancellation });\r\n\t\t}\r\n\r\n\t\treturn audio;\r\n\t}\r\n\r\n\tgetVideoConstraints(option) {\r\n\t\tlet { video, sampleRate, width, height } = option || {};\r\n\r\n\t\tif (\r\n\t\t\ttypeof sampleRate === \"undefined\" &&\r\n\t\t\ttypeof width === \"undefined\" &&\r\n\t\t\ttypeof height === \"undefined\"\r\n\t\t) {\r\n\t\t\tvideo || (video = true);\r\n\t\t} else {\r\n\t\t\tvideo = {};\r\n\t\t\tsampleRate && (video[\"sampleRate\"] = sampleRate);\r\n\t\t\twidth && (video[\"width\"] = width);\r\n\t\t\theight && (video[\"height\"] = height);\r\n\t\t}\r\n\r\n\t\treturn video;\r\n\t}\r\n\r\n\tgetConfigOptions(option) {\r\n\t\tlet { mimeType, audioBitsPerSecond, videoBitsPerSecond } = option || {};\r\n\t\tlet options = {\r\n\t\t\tmimeType: mimeType || this.getSupportedMimeTypes()?.[0],\r\n\t\t};\r\n\t\taudioBitsPerSecond && (options[\"audioBitsPerSecond\"] = audioBitsPerSecond);\r\n\t\tvideoBitsPerSecond && (options[\"videoBitsPerSecond\"] = videoBitsPerSecond);\r\n\r\n\t\treturn options;\r\n\t}\r\n\r\n\tsetAudioConfig(option: AudioOption) {\r\n\t\tlet audio = this.getAudioConstraints(option);\r\n\t\tlet options = this.getConfigOptions(option);\r\n\r\n\t\tthis.setMediaStreamConstraints({ audio })\r\n\t\t\t.setMediaRecorderOptions(options)\r\n\t\t\t.setTimeSlice(option?.timeSlice);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetVideoConfig(option: VideoOption) {\r\n\t\tlet audio = this.getAudioConstraints(option);\r\n\t\tlet video = this.getVideoConstraints(option);\r\n\t\tlet options = this.getConfigOptions(option);\r\n\r\n\t\tthis.setMediaStreamConstraints({ video, audio })\r\n\t\t\t.setMediaRecorderOptions(options)\r\n\t\t\t.setTimeSlice(option?.timeSlice);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetScreenConfig(option: ScreenOption) {\r\n\t\tlet audio = this.getAudioConstraints(option);\r\n\t\tlet video = this.getVideoConstraints(option);\r\n\t\tlet options = this.getConfigOptions(option);\r\n\r\n\t\tthis.setMediaStreamConstraints({ video, audio })\r\n\t\t\t.setMediaRecorderOptions(options)\r\n\t\t\t.setTimeSlice(option?.timeSlice);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetTimeSlice(timeSlice: number) {\r\n\t\ttimeSlice && (this.timeSlice = timeSlice);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetTimeSlice() {\r\n\t\treturn this.timeSlice;\r\n\t}\r\n\r\n\tgetMediaType() {\r\n\t\treturn this.mediaType;\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param setMediaType \r\n\t * audio:  Boolean;\r\n\t\tvideo:  Boolean;\r\n\t\tscreen:  Boolean;\r\n\t * @returns \r\n\t */\r\n\tsetMediaType(mediaType: MediaType) {\r\n\t\tthis.mediaType = mediaType;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetMedisStream(): MediaStream | null {\r\n\t\treturn this.mediaStream;\r\n\t}\r\n\r\n\tasync setMediaStream(constraints?: MediaStreamConstraints) {\r\n\t\tthis.setMediaStreamConstraints(constraints);\r\n\t\tconst _constraints = this.getMediaStreamConstraints();\r\n\t\tconst mediaType = this.getMediaType();\r\n\t\tthis.setMediaState(\"wait\");\r\n\t\ttry {\r\n\t\t\tthis.mediaStream =\r\n\t\t\t\tmediaType === \"screen\"\r\n\t\t\t\t\t? await navigator.mediaDevices.getDisplayMedia(_constraints)\r\n\t\t\t\t\t: await navigator.mediaDevices.getUserMedia(_constraints);\r\n\t\t\tthis.setMediaState(\"ready\");\r\n\t\t\tthis.setSoundMeter();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.setMediaState(\"inactive\");\r\n\t\t\tthis.emit(\"error\", { type: \"setMedisStream\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tgetMediaRecorder(): MediaRecorder | null {\r\n\t\treturn this.mediaRecorder;\r\n\t}\r\n\r\n\tsetMediaRecorder(options?: MediaRecorderOptions) {\r\n\t\tthis.setMediaRecorderOptions(options);\r\n\t\tthis.mediaRecorder = new MediaRecorder(\r\n\t\t\tthis.mediaStream,\r\n\t\t\tthis.getMediaRecorderOptions(),\r\n\t\t);\r\n\r\n\t\tthis.mediaRecorder.onerror = (err: any) => {\r\n\t\t\tthis.emit(\"error\", { type: \"mediaRecorder\", message: err });\r\n\t\t};\r\n\r\n\t\t//  stream  blob \r\n\t\tthis.mediaRecorder.ondataavailable = (blobEvent: BlobEvent) => {\r\n\t\t\tthis.emit(\"dataavailable\", blobEvent);\r\n\t\t\tthis.mediaBlobs.push(blobEvent.data);\r\n\t\t};\r\n\r\n\t\tthis.mediaRecorder.onstart = (event: any) => {\r\n\t\t\tthis.mediaBlobs = [];\r\n\t\t\tthis.emit(\"start\", event);\r\n\t\t};\r\n\r\n\t\tthis.mediaRecorder.onstop = (event: any) => {\r\n\t\t\tthis.soundMeter.stop();\r\n\t\t\tthis.emit(\"stop\", event);\r\n\t\t};\r\n\r\n\t\tthis.mediaRecorder.onpause = (event: any) => {\r\n\t\t\tthis.emit(\"pause\", event);\r\n\t\t};\r\n\r\n\t\tthis.mediaRecorder.onresume = (event: any) => {\r\n\t\t\tthis.emit(\"resume\", event);\r\n\t\t};\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetMediaBlobs(): Blob[] {\r\n\t\treturn this.mediaBlobs;\r\n\t}\r\n\r\n\tgetMediaState(): MediaState {\r\n\t\treturn this.mediaState;\r\n\t}\r\n\r\n\tprivate setMediaState(mediaState: MediaState) {\r\n\t\tthis.mediaState = mediaState;\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// type RecordingState = \"inactive\" | \"paused\" | \"recording\";\r\n\tgetRecorderState(): string {\r\n\t\treturn this.getMediaRecorder()?.state || \"inactive\";\r\n\t}\r\n\r\n\tgetMediaStreamConstraints(): MediaStreamConstraints | null {\r\n\t\treturn this.mediaStreamConstraints;\r\n\t}\r\n\r\n\t/**\r\n     *  \r\n     * @param constraints \r\n     * audio\r\n        video\r\n        audioConstraints  videoConstraints\r\n        facingMode\r\n        width  height\r\n        frameRate\r\n        deviceId ID\r\n     * @returns \r\n     */\r\n\tsetMediaStreamConstraints(constraints?: MediaStreamConstraints) {\r\n\t\tconst _constraints = {\r\n\t\t\t...this.getMediaStreamConstraints(),\r\n\t\t\t...constraints,\r\n\t\t};\r\n\t\tthis.mediaStreamConstraints = _constraints;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetMediaRecorderOptions(): MediaRecorderOptions | null {\r\n\t\treturn this.mediaRecorderOptions;\r\n\t}\r\n\r\n\t/**\r\n     * \r\n     * @param options \r\n     * mimeType audio/webmvideo/webm \r\n        audioBitsPerSecond  videoBitsPerSecond\r\n        audioChannels\r\n        videoFrameRate\r\n        width  height\r\n        videoSize640x480\r\n        echoCancellation\r\n     * @returns \r\n     */\r\n\tsetMediaRecorderOptions(options?: MediaRecorderOptions) {\r\n\t\tconst _options = { ...this.getMediaRecorderOptions(), ...options };\r\n\t\tthis.mediaRecorderOptions = _options;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tisReady(type: string = \"isReady\"): boolean {\r\n\t\tconst mediaState = this.getMediaState();\r\n\t\tif (mediaState === \"ready\") {\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\tconst err = `the cureent mediaState is ${mediaState}, Please use open function`;\r\n\t\t\tthis.emit(\"error\", { type, message: err });\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tonerror(callback?: Function) {\r\n\t\tcallback && this.on(\"error\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// \r\n\tasync create() {\r\n\t\tif (this.getMediaState() === \"inactive\") {\r\n\t\t\tconst media = await this.setMediaStream();\r\n\t\t\tif (media) {\r\n\t\t\t\tthis.setMediaRecorder();\r\n\t\t\t\tthis.emit(\"create\");\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\tthis.emit(\"error\", {\r\n\t\t\t\ttype: \"create\",\r\n\t\t\t\tmessage: `mediaState: ${this.getMediaState()}`,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\toncreate(callback?: Function) {\r\n\t\tcallback && this.on(\"create\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// \r\n\tdestroy() {\r\n\t\tif (this.getMediaState() !== \"inactive\") {\r\n\t\t\tthis.getRecorderState() !== \"inactive\" && this.stop();\r\n\t\t\tthis.mediaStream?.getTracks().forEach((track) => track.stop());\r\n\t\t\tthis.mediaBlobs = [];\r\n\t\t\tthis.mediaStream = null;\r\n\t\t\tthis.mediaRecorder = null;\r\n\t\t\tthis.setMediaState(\"inactive\");\r\n\t\t\tthis.emit(\"destroy\");\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\tthis.emit(\"error\", {\r\n\t\t\t\ttype: \"destroy\",\r\n\t\t\t\tmessage: `mediaState: ${this.getMediaState()}`,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tondestroy(callback?: Function) {\r\n\t\tcallback && this.on(\"destroy\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tondataavailable(callback?: Function) {\r\n\t\tcallback && this.on(\"dataavailable\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// \r\n\tstart(timeSlice?: number) {\r\n\t\tif (!this.isReady()) return this;\r\n\t\ttry {\r\n\t\t\tthis.setTimeSlice(timeSlice);\r\n\t\t\ttimeSlice = this.getTimeSlice();\r\n\t\t\ttimeSlice\r\n\t\t\t\t? this.mediaRecorder?.start(timeSlice)\r\n\t\t\t\t: this.mediaRecorder?.start();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"start\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tonstart(callback?: Function) {\r\n\t\tcallback && this.on(\"start\", callback);\r\n\t}\r\n\r\n\tstop() {\r\n\t\tif (!this.isReady()) return this;\r\n\t\ttry {\r\n\t\t\tthis.mediaRecorder?.stop();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"stop\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tonstop(callback?: Function) {\r\n\t\tcallback && this.on(\"stop\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// \r\n\tpause() {\r\n\t\tif (!this.isReady()) return this;\r\n\t\ttry {\r\n\t\t\tthis.mediaRecorder?.pause();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"pause\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tonpause(callback?: Function) {\r\n\t\tcallback && this.on(\"pause\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// \r\n\tresume() {\r\n\t\tif (!this.isReady()) return this;\r\n\t\ttry {\r\n\t\t\tthis.mediaRecorder?.resume();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"resume\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tonresume(callback?: Function) {\r\n\t\tcallback && this.on(\"resume\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetSoundMeter(mediaStream?: MediaStream) {\r\n\t\ttry {\r\n\t\t\tconst audioContext = new AudioContext();\r\n\t\t\tthis.soundMeter = new SoundMeter(audioContext);\r\n\t\t\tthis.soundMeter.connectToSource(mediaStream || this.mediaStream);\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"setSoundMeter\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tgetSoundMeter(): SoundMeter {\r\n\t\treturn this.soundMeter;\r\n\t}\r\n\r\n\tgetBlob(options?: BlobPropertyBag): Blob {\r\n\t\tif (!this.isReady()) return;\r\n\t\tconst { mimeType } = this.getMediaRecorderOptions();\r\n\t\tif (!options) {\r\n\t\t\toptions = {\r\n\t\t\t\ttype: mimeType,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst blob = new Blob(this.mediaBlobs, options);\r\n\t\treturn blob;\r\n\t}\r\n\r\n\t// BlobUrl\r\n\tgetBlobUrl(options?: BlobPropertyBag): string {\r\n\t\tif (!this.isReady()) return;\r\n\t\ttry {\r\n\t\t\tconst blob = this.getBlob(options);\r\n\t\t\tconst mediaUrl = URL.createObjectURL(blob);\r\n\t\t\treturn mediaUrl;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"getBlobUrl\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tdownloadBlob(filename) {\r\n\t\tconst url = this.getBlobUrl();\r\n\t\tconst a = document.createElement(\"a\");\r\n\t\ta.style.display = \"none\";\r\n\t\ta.href = url;\r\n\t\ta.download = `${filename || \"mediajs\"}.webm`;\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.click();\r\n\t\tsetTimeout(() => {\r\n\t\t\tdocument.body.removeChild(a);\r\n\t\t\twindow.URL.revokeObjectURL(url);\r\n\t\t}, 150);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// \r\n\tgetDuration(blob?: Blob): Promise<number> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tblob = blob || this.getBlob();\r\n\r\n\t\t\tconst _this = this;\r\n\t\t\tconst audioContext = new AudioContext();\r\n\t\t\tconst reader = new FileReader();\r\n\r\n\t\t\treader.onload = function () {\r\n\t\t\t\tconst arrayBuffer = this.result as ArrayBuffer;\r\n\t\t\t\taudioContext.decodeAudioData(\r\n\t\t\t\t\tarrayBuffer,\r\n\t\t\t\t\t(buffer) => {\r\n\t\t\t\t\t\tconst duration = Math.round(buffer.duration * 1000);\r\n\t\t\t\t\t\tresolve(duration);\r\n\t\t\t\t\t},\r\n\t\t\t\t\t(err) => {\r\n\t\t\t\t\t\t_this.emit(\"error\", \"getDuration\", `getDuration function is err`);\r\n\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t},\r\n\t\t\t\t);\r\n\t\t\t};\r\n\r\n\t\t\tif (blob) {\r\n\t\t\t\treader.readAsArrayBuffer(blob);\r\n\t\t\t} else {\r\n\t\t\t\t_this.emit(\"error\", \"getDuration\", `blob is Empty`);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tasync _enumerateDevices() {\r\n\t\ttry {\r\n\t\t\tconst devices = await navigator.mediaDevices.enumerateDevices();\r\n\t\t\treturn devices;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"_enumerateDevices\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tgetSupportedMimeTypes(): string[] {\r\n\t\tconst media = this.mediaType === \"audio\" ? \"audio\" : \"video\";\r\n\t\tconst types = [\r\n\t\t\t\"webm\",\r\n\t\t\t\"mp4\",\r\n\t\t\t\"ogg\",\r\n\t\t\t\"mov\",\r\n\t\t\t\"avi\",\r\n\t\t\t\"wmv\",\r\n\t\t\t\"flv\",\r\n\t\t\t\"mkv\",\r\n\t\t\t\"ts\",\r\n\t\t\t\"x-matroska\",\r\n\t\t];\r\n\t\tconst codecs = [\r\n\t\t\t\"vp9\",\r\n\t\t\t\"vp9.0\",\r\n\t\t\t\"vp8\",\r\n\t\t\t\"vp8.0\",\r\n\t\t\t\"avc1\",\r\n\t\t\t\"av1\",\r\n\t\t\t\"h265\",\r\n\t\t\t\"h264\",\r\n\t\t];\r\n\t\tconst supported: string[] = [];\r\n\t\tconst isSupported = MediaRecorder.isTypeSupported;\r\n\t\ttypes.forEach((type: string) => {\r\n\t\t\tconst mimeType = `${media}/${type}`;\r\n\t\t\tcodecs.forEach((codec: string) =>\r\n\t\t\t\t[\r\n\t\t\t\t\t`${mimeType};codecs=${codec}`,\r\n\t\t\t\t\t`${mimeType};codecs=${codec.toUpperCase()}`,\r\n\t\t\t\t].forEach((variation) => {\r\n\t\t\t\t\tif (isSupported(variation)) supported.push(variation);\r\n\t\t\t\t}),\r\n\t\t\t);\r\n\t\t\tif (isSupported(mimeType)) supported.push(mimeType);\r\n\t\t});\r\n\t\treturn supported;\r\n\t}\r\n\r\n\t_isTypeSupported(mimeType: string): boolean {\r\n\t\treturn MediaRecorder.isTypeSupported(mimeType);\r\n\t}\r\n\r\n\tgetVideoTracks(stream?: MediaStream): MediaStreamTrack[] {\r\n\t\tstream = stream || this.mediaStream;\r\n\t\treturn stream.getVideoTracks();\r\n\t}\r\n\r\n\tconnectVideo(video: HTMLVideoElement) {\r\n\t\tvideo.srcObject = this.mediaStream;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tconnectAudio(audio: HTMLAudioElement) {\r\n\t\taudio.srcObject = this.mediaStream;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsnapshot(canvas: HTMLCanvasElement, video: HTMLVideoElement) {\r\n\t\tcanvas.width = video.videoWidth;\r\n\t\tcanvas.height = video.videoHeight;\r\n\t\tcanvas.getContext(\"2d\").drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\t\treturn this;\r\n\t}\r\n}\r\n\r\nexport { Media };\r\n\r\nexport default Media;\r\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n// Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\nimport * as sdp from 'sdp';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings,\n    // Expose sdp as a convenience. For production apps include directly.\n    sdp,\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","import { Media } from \"./media\";\r\nimport type { AudioOption, VideoOption, ScreenOption } from \"./type\";\r\n\r\nfunction audio(option?: AudioOption) {\r\n\tconst audio = new Media(\"audio\", option);\r\n\r\n\treturn audio;\r\n}\r\n\r\nfunction video(option?: VideoOption) {\r\n\tconst video = new Media(\"video\", option);\r\n\treturn video;\r\n}\r\n\r\nfunction screen(option?: ScreenOption) {\r\n\tconst screen = new Media(\"screen\", option);\r\n\treturn screen;\r\n}\r\n\r\nexport { audio, video, screen };\r\nexport default Media;\r\n","{\r\n\t\"name\": \"mediajs\",\r\n\t\"version\": \"1.0.0\",\r\n\t\"keywords\": [\r\n\t\t\"mediajs\",\r\n\t\t\"webrtc\",\r\n\t\t\"adapter\",\r\n\t\t\"audio\",\r\n\t\t\"video\",\r\n\t\t\"screen\"\r\n\t],\r\n\t\"description\": \"MediaJS is a JavaScript library that can record audio, video and screen \",\r\n\t\"homepage\": \"https://mediajs.com\",\r\n\t\"bugs\": {\r\n\t\t\"url\": \"https://github.com/027xiguapi/mediajs/issues\"\r\n\t},\r\n\t\"repository\": {\r\n\t\t\"type\": \"git\",\r\n\t\t\"url\": \"https://github.com/027xiguapi/mediajs\"\r\n\t},\r\n\t\"license\": \"MIT\",\r\n\t\"contributors\": [\r\n\t\t\"027xiguapi <458813868@qq.com>\"\r\n\t],\r\n\t\"files\": [\r\n\t\t\"dist/*\"\r\n\t],\r\n\t\"sideEffects\": [\r\n\t\t\"src/global.ts\",\r\n\t\t\"src/supports.ts\"\r\n\t],\r\n\t\"main\": \"dist/bundler.cjs\",\r\n\t\"module\": \"dist/bundler.mjs\",\r\n\t\"browser-minified\": \"dist/mediajs.global.min.js\",\r\n\t\"browser-unminified\": \"dist/mediajs.global.js\",\r\n\t\"types\": \"dist/types.d.ts\",\r\n\t\"engines\": {\r\n\t\t\"node\": \">= 18\"\r\n\t},\r\n\t\"targets\": {\r\n\t\t\"types\": {\r\n\t\t\t\"source\": \"src/exports.ts\"\r\n\t\t},\r\n\t\t\"main\": {\r\n\t\t\t\"source\": \"src/exports.ts\",\r\n\t\t\t\"sourceMap\": {\r\n\t\t\t\t\"inlineSources\": true\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"module\": {\r\n\t\t\t\"source\": \"src/exports.ts\",\r\n\t\t\t\"includeNodeModules\": [\r\n\t\t\t\t\"eventemitter3\"\r\n\t\t\t],\r\n\t\t\t\"sourceMap\": {\r\n\t\t\t\t\"inlineSources\": true\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"browser-minified\": {\r\n\t\t\t\"context\": \"browser\",\r\n\t\t\t\"outputFormat\": \"global\",\r\n\t\t\t\"optimize\": true,\r\n\t\t\t\"engines\": {\r\n\t\t\t\t\"browsers\": \"cover 99%, not dead\"\r\n\t\t\t},\r\n\t\t\t\"source\": \"src/global.ts\"\r\n\t\t},\r\n\t\t\"browser-unminified\": {\r\n\t\t\t\"context\": \"browser\",\r\n\t\t\t\"outputFormat\": \"global\",\r\n\t\t\t\"optimize\": false,\r\n\t\t\t\"engines\": {\r\n\t\t\t\t\"browsers\": \"cover 99%, not dead\"\r\n\t\t\t},\r\n\t\t\t\"source\": \"src/global.ts\"\r\n\t\t}\r\n\t},\r\n\t\"scripts\": {\r\n\t\t\"contributors\": \"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\\"chore(contributors): update and sort contributors list\\\"\",\r\n\t\t\"check\": \"tsc --noEmit\",\r\n\t\t\"watch\": \"parcel watch\",\r\n\t\t\"build\": \"rimraf dist && parcel build\",\r\n\t\t\"prepublishOnly\": \"npm run build\",\r\n\t\t\"format\": \"prettier --write .\",\r\n\t\t\"semantic-release\": \"semantic-release\",\r\n\t\t\"mocha\": \"mocha --timeout 5000 'examples/src/content/**/test.js'\"\r\n\t},\r\n\t\"devDependencies\": {\r\n\t\t\"@parcel/config-default\": \"^2.8.1\",\r\n\t\t\"@parcel/packager-ts\": \"^2.8.1\",\r\n\t\t\"@parcel/transformer-typescript-tsc\": \"^2.8.1\",\r\n\t\t\"@parcel/transformer-typescript-types\": \"^2.8.1\",\r\n\t\t\"@semantic-release/changelog\": \"^6.0.1\",\r\n\t\t\"@semantic-release/git\": \"^10.0.1\",\r\n\t\t\"@swc/core\": \"^1.3.27\",\r\n\t\t\"chai\": \"^4.3.7\",\r\n\t\t\"mocha\": \"^10.2.0\",\r\n\t\t\"parcel\": \"^2.8.1\",\r\n\t\t\"parcel-transformer-tsc-sourcemaps\": \"^1.0.2\",\r\n\t\t\"prettier\": \"^2.6.2\",\r\n\t\t\"selenium-webdriver\": \"^4.8.2\",\r\n\t\t\"semantic-release\": \"^20.0.0\",\r\n\t\t\"typescript\": \"^4.5.5\"\r\n\t},\r\n\t\"dependencies\": {\r\n\t\t\"@swc/helpers\": \"^0.4.0\",\r\n\t\t\"webrtc-adapter\": \"^8.0.0\"\r\n\t}\r\n}","import { audio, video, screen } from \"./exports\";\r\nimport { Env } from \"./env\";\r\nimport { version } from \"../package.json\";\r\n\r\n(<any>window).mediajs = {\r\n\taudio,\r\n\tvideo,\r\n\tscreen,\r\n\tEnv,\r\n\tversion,\r\n};\r\n/** @deprecated Should use mediajs namespace */\r\n"],"names":["EventTarget","SoundMeter","$98829911bec90a73$var$EventTarget","this","eventBus","error","create","destroy","start","stop","pause","resume","dataavailable","prototype","on","name","callback","callbackList","push","emit","_this","args","_i","arguments","length","evnetName","forEach","fn","apply","console","concat","off","index","findIndex","fns","splice","once","decor","$98829911bec90a73$export$2e2bcd8739ae039","$3c0995f39e1ff2ff$export$2e2bcd8739ae039","context","instant","slow","clip","script","createScriptProcessor","onaudioprocess","event","i","input","inputBuffer","getChannelData","sum","clipcount","Math","abs","sqrt","getInstant","getSlow","getClip","connectToSource","stream","mic","createMediaStreamSource","connect","destination","e","disconnect","$f45b8b391889f698$export$2e2bcd8739ae039","obj","key","value","Object","defineProperty","enumerable","configurable","writable","$cad70b812f66c965$export$2e2bcd8739ae039","constructor","Symbol","$3ad24411f40effab$var$logDisabled_","$3ad24411f40effab$var$deprecationWarnings_","$3ad24411f40effab$export$e3c02be309be1f23","uastring","expr","pos","match","parseInt","$3ad24411f40effab$export$1f48841962b828b1","window1","eventNameToWrap","wrapper","RTCPeerConnection","proto","nativeAddEventListener","addEventListener","nativeEventName","cb","wrappedCallback","modifiedEvent","handleEvent","_eventMap","Map","set","nativeRemoveEventListener","removeEventListener","has","unwrappedCb","get","size","keys","$3ad24411f40effab$export$afbfee8cc06fd3e4","bool","Error","$3ad24411f40effab$export$51516be4b019e41e","$3ad24411f40effab$export$bef1f36f5486a6a3","window","log","$3ad24411f40effab$export$cdd73fc4100a6ef4","oldMethod","newMethod","warn","$3ad24411f40effab$var$isObject","val","toString","call","$3ad24411f40effab$export$15384eac40dc88c8","data","reduce","accumulator","isObj","isEmptyObject","undefined","assign","$3ad24411f40effab$export$571b373e75babb58","stats","base","resultSet","id","endsWith","$3ad24411f40effab$export$93439ffc3f787d51","result","track","outbound","streamStatsType","filteredResult","trackStats","type","trackIdentifier","trackStat","trackId","$54bd48c052a5912b$export$2e2bcd8739ae039","arr","Array","isArray","$222d9e604fb85e89$export$2e2bcd8739ae039","iter","iterator","from","$2327522034b424cf$export$2e2bcd8739ae039","TypeError","$392d44f3d76cb68d$export$2e2bcd8739ae039","len","arr2","$3b3df927e895a103$export$2e2bcd8739ae039","o","minLen","n","slice","test","$868b7bbd05aba6a5$export$2e2bcd8739ae039","$44d724c26ac3bf00$var$logging","$44d724c26ac3bf00$export$1ed4910f4d37dc5e","browserDetails","navigator","mediaDevices","constraintsToChrome_","c","mandatory","optional","cc","r","ideal","exact","min","max","oldname_","prefix","charAt","toUpperCase","oc","mix","advanced","shimConstraints_","constraints","func","version","JSON","parse","stringify","audio","remap","a","b","video","face","facingMode","matches","getSupportedFacingModeLies","getSupportedConstraints","enumerateDevices","then","devices","dev","filter","d","kind","find","some","label","toLowerCase","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","getUserMedia","onSuccess","onError","webkitGetUserMedia","bind","origGetUserMedia","cs","getAudioTracks","getVideoTracks","getTracks","DOMException","Promise","reject","$780004c22528a281$export$97270b87351d9c04","getSourceId","getDisplayMedia","sourceId","widthSpecified","width","heightSpecified","height","frameRateSpecified","frameRate","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","$5bbc2afa3b7f8fdc$export$33ee24e7a300bcd1","MediaStream","webkitMediaStream","$5bbc2afa3b7f8fdc$export$f358708f68ab068","_ontrack","f","origSetRemoteDescription","setRemoteDescription","_ontrackpoly","te","receiver","getReceivers","Event","transceiver","streams","dispatchEvent","$5bbc2afa3b7f8fdc$export$a41a030a2842f5d6","shimSenderWithDtmf","pc","dtmf","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","addTrack","sender","origRemoveTrack","removeTrack","idx","indexOf","origAddStream","addStream","origRemoveStream","removeStream","s","RTCRtpSender","origGetSenders","senders","$5bbc2afa3b7f8fdc$export$90608323826f0b17","origGetStats","getStats","_arguments","selector","onSucc","onErr","fixChromeStats_","response","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","map","resolve","$5bbc2afa3b7f8fdc$export$f2f0f2338114eb4b","RTCRtpReceiver","origGetReceivers","receivers","srcElement","MediaStreamTrack","err","$5bbc2afa3b7f8fdc$export$30e3cdd46f8d5100","getLocalStreams","_shimmedLocalStreams","streamId","existingSenders","newSenders","newSender","$5bbc2afa3b7f8fdc$export$9588259fcf4ebc91","replaceInternalStreamId","description","sdp","_reverseStreams","internalId","externalStream","internalStream","_streams","replace","RegExp","RTCSessionDescription","origGetLocalStreams","nativeStreams","newStream","signalingState","t","oldStream","method","nativeMethod","methodObj","desc","origSetLocalDescription","setLocalDescription","origLocalDescription","getOwnPropertyDescriptor","streamid","$5bbc2afa3b7f8fdc$export$852a08dda9a55ea7","webkitRTCPeerConnection","RTCIceCandidate","$5bbc2afa3b7f8fdc$export$341293bbeaae37cb","target","getConfiguration","sdpSemantics","$e18b9fd686d955b6$export$2e2bcd8739ae039","$32ebd230187cdc07$export$2e2bcd8739ae039","$d9e2d283d71d31cd$export$2e2bcd8739ae039","$617de8ce5e656e6a$export$1ed4910f4d37dc5e","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","$d450e45a0fa9ff70$export$97270b87351d9c04","preferredMediaSource","code","mediaSource","$748ea3f175d41f0d$export$f358708f68ab068","RTCTrackEvent","$748ea3f175d41f0d$export$852a08dda9a55ea7","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","$748ea3f175d41f0d$export$f0525502095c04ef","$748ea3f175d41f0d$export$83d69126527b1171","$748ea3f175d41f0d$export$825e523ef749bd8c","$748ea3f175d41f0d$export$ff9cb3bc8990e8f7","DataChannel","RTCDataChannel","$748ea3f175d41f0d$export$70c77533b6e9908d","origAddTransceiver","addTransceiver","setParametersPromises","sendEncodings","shouldPerformCheck","encodingParam","rid","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","params","getParameters","encodings","setParameters","$748ea3f175d41f0d$export$66238223c298fbaa","origGetParameters","$748ea3f175d41f0d$export$51beccf0e777b843","origCreateOffer","createOffer","all","$748ea3f175d41f0d$export$df0b46e7cef08150","origCreateAnswer","createAnswer","$b6191fc5d41a5274$export$8df41282f4fdcea2","_localStreams","_addTrack","_len","_key","tracks","$b6191fc5d41a5274$export$762aa4cbb4f2f857","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","$b6191fc5d41a5274$export$da31df245debdd3","addIceCandidate","successCallback","failureCallback","options","promise","withCallback","candidate","$b6191fc5d41a5274$export$1ed4910f4d37dc5e","_getUserMedia","$b6191fc5d41a5274$export$494a01ac68ba81ac","errcb","$b6191fc5d41a5274$export$671a8b47b41b6f41","OrigPeerConnection","pcConfig","pcConstraints","iceServers","newIceServers","server","urls","url","generateCertificate","$b6191fc5d41a5274$export$85d53da088cb1b14","$b6191fc5d41a5274$export$d444266503fdd2d4","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","direction","setDirection","offerToReceiveVideo","videoTransceiver","$b6191fc5d41a5274$export$857cd739a7b795d2","AudioContext","webkitAudioContext","$8107c97ca10aeebe$var$SDPUtils","$b89b79134adc8918$export$cf133661e444ccfe","NativeRTCIceCandidate","substring","nativeCandidate","parsedCandidate","$parcel$interopDefault","$8107c97ca10aeebe$exports","parseCandidate","augmentedCandidate","toJSON","sdpMid","sdpMLineIndex","usernameFragment","$b89b79134adc8918$export$fdafb8d8280e29b5","relayProtocol","priority","$b89b79134adc8918$export$a99147c78a56edc4","_sctp","remoteIsFirefox","canSendMaxMessageSize","browser","sections","splitSections","shift","mediaSection","mLine","parseMLine","protocol","sctpInDescription","maxMessageSize","isFirefox","getRemoteFirefoxVersion","canSendMMS","remoteMMS","matchPrefix","getMaxMessageSize","Number","POSITIVE_INFINITY","sctp","$b89b79134adc8918$export$d461c8d5c5db5da7","wrapDcSend","dc","origDataChannelSend","send","byteLength","readyState","origCreateDataChannel","createDataChannel","dataChannel","channel","$b89b79134adc8918$export$63bb816cc75460","completed","checking","iceConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","$b89b79134adc8918$export$a57d114344295149","nativeSRD","split","line","trim","join","$b89b79134adc8918$export$51d5e40b48c771c7","nativeAddIceCandidate","$b89b79134adc8918$export$7170d04e59f9d553","nativeSetLocalDescription","generateIdentifier","random","localCName","splitLines","blob","part","getDescription","getMediaSections","parts","foundation","component","ip","address","port","relatedAddress","relatedPort","tcpType","ufrag","writeCandidate","parseIceOptions","parseRtpMap","parsed","payloadType","clockRate","channels","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","uri","attributes","writeExtmap","headerExtension","preferredId","parseFmtp","kv","j","writeFmtp","parameters","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","parseSsrcGroup","semantics","ssrcs","getMid","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","iceLite","parseRtpParameters","codecs","headerExtensions","fecMechanisms","rtcp","mline","profile","rtpmapline","fmtps","wildcardRtcpFb","existingFeedback","writeRtpDescription","caps","maxptime","extension","parseRtpEncodingParameters","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","apt","encParam","codecPayloadType","rtx","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","cname","rsize","reducedSize","compound","mux","writeRtcpParameters","parseMsid","spec","planB","msidParts","parseSctpDescription","maxSizeLine","isNaN","sctpPort","fmt","sctpMapLines","writeSctpDescription","media","output","generateSessionId","substr","writeSessionBoilerplate","sessId","sessVer","sessUser","getDirection","getKind","isRejected","parseOLine","username","sessionId","sessionVersion","netType","addressType","isValidSDP","class_1","_super","Media","$fbdf9bd273a82fe8$var$adapter","shimChrome","shimFirefox","shimSafari","logging","mozGetUserMedia","userAgent","isSecureContext","supportsUnifiedPlan","RTCRtpTransceiver","$3ad24411f40effab$export$2d31490a0c05f094","adapter","commonShim","$b89b79134adc8918$exports","extractVersion","disableLog","disableWarnings","$5bbc2afa3b7f8fdc$exports","shimPeerConnection","browserShim","shimAddIceCandidateNullOrEmpty","shimParameterlessSetLocalDescription","shimGetUserMedia","shimMediaStream","shimOnTrack","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimGetStats","shimSenderReceiverGetStats","fixNegotiationNeeded","shimRTCIceCandidate","shimRTCIceCandidateRelayProtocol","shimConnectionState","shimMaxMessageSize","shimSendThrowTypeError","removeExtmapAllowMixed","$748ea3f175d41f0d$exports","shimRemoveStream","shimSenderGetStats","shimReceiverGetStats","shimRTCDataChannel","shimAddTransceiver","shimGetParameters","shimCreateOffer","shimCreateAnswer","$b6191fc5d41a5274$exports","shimRTCIceServerUrls","shimCreateOfferLegacy","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","shimAudioContext","$fbdf9bd273a82fe8$export$2e2bcd8739ae039","$2227872586617424$var$webRTCAdapter","$2227872586617424$export$6c0517834721cef7","isIOS","platform","supportedBrowsers","minFirefoxVersion","minChromeVersion","minSafariVersion","isAudioContextSupported","isMediaDevicesSupported","isGetUserMediaSupported","isMediaRecorderSupported","MediaRecorder","isAudioWorkletNode","AudioWorkletNode","isBrowserSupported","getBrowser","getVersion","isUnifiedPlanSupported","$a84b5b943c3df4b3$export$7fc53215244aec38","$a84b5b943c3df4b3$var$__extends","mediaType","option","_this_1","mediaStream","mediaRecorder","mediaBlobs","soundMeter","mediaState","mediaStreamConstraints","mediaRecorderOptions","timeSlice","setMediaType","setConfig","setAudioConfig","setVideoConfig","setScreenConfig","getAudioConstraints","_a","sampleRate","echoCancellation","getVideoConstraints","getConfigOptions","_b","mimeType","audioBitsPerSecond","videoBitsPerSecond","getSupportedMimeTypes","setMediaStreamConstraints","setMediaRecorderOptions","setTimeSlice","getTimeSlice","getMediaType","getMedisStream","setMediaStream","_constraints","getMediaStreamConstraints","setMediaState","_c","sent","setSoundMeter","err_1","getMediaRecorder","setMediaRecorder","getMediaRecorderOptions","onerror","ondataavailable","blobEvent","onstart","onstop","onpause","onresume","getMediaBlobs","getMediaState","getRecorderState","state","$a84b5b943c3df4b3$var$__assign","_options","isReady","oncreate","ondestroy","audioContext","getSoundMeter","getBlob","Blob","getBlobUrl","URL","createObjectURL","downloadBlob","filename","document","createElement","style","display","href","download","body","appendChild","click","setTimeout","removeChild","revokeObjectURL","getDuration","reader","FileReader","onload","arrayBuffer","decodeAudioData","buffer","duration","round","readAsArrayBuffer","_enumerateDevices","err_2","supported","isSupported","isTypeSupported","variation","_isTypeSupported","connectVideo","srcObject","connectAudio","snapshot","canvas","videoWidth","videoHeight","getContext","drawImage","$a84b5b943c3df4b3$exports","$705e5a186df75920$exports","mediajs","screen","Env"],"version":3,"file":"mediajs.global.min.js.map"}