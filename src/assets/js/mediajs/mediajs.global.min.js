!function(){function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var r={};e(r,"Media",(function(){return Le}),(function(e){return Le=e}));var n,i,o=((n=function(){this.eventBus={error:[],create:[],destroy:[],start:[],stop:[],pause:[],resume:[],dataavailable:[]}}).prototype.on=function(e,t){var r=this.eventBus[e]||[];r.push(t),this.eventBus[e]=r},n.prototype.emit=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=this.eventBus[e];i?i.forEach((function(e){e.apply(t,r)})):console.error("emit ".concat(e," is not find"))},n.prototype.off=function(e,t){var r=this.eventBus[e];if(r&&t){var n=r.findIndex((function(e){return e===t}));r.splice(n,1)}else console.error("off ".concat(e," is not find"))},n.prototype.once=function(e,t){var r=this,n=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];t.apply(r,i),r.off(e,n)};this.on(e,n)},n),a=o,s=((i=function(e){var t=this;this.instant=0,this.slow=0,this.clip=0,this.context=e,this.script=e.createScriptProcessor(2048,1,1),this.script.onaudioprocess=function(e){var r,n=e.inputBuffer.getChannelData(0),i=0,o=0;for(r=0;r<n.length;++r)i+=n[r]*n[r],Math.abs(n[r])>.99&&(o+=1);t.instant=Math.sqrt(i/n.length),t.slow=.95*t.slow+.05*t.instant,t.clip=o/n.length}}).prototype.getInstant=function(){return this.instant},i.prototype.getSlow=function(){return this.slow},i.prototype.getClip=function(){return this.clip},i.prototype.connectToSource=function(e){try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination)}catch(e){console.error(e)}},i.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()},i);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){return e&&e.constructor===Symbol?"symbol":typeof e}var d=!0,u=!0;function f(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function h(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=r(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),i.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(r))return o.apply(this,arguments);var n=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function m(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":p(e))+". Please use a boolean."):(d=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function l(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":p(e))+". Please use a boolean."):(u=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function v(){if("object"==typeof window){if(d)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function y(e,t){u&&console.warn(e+" is deprecated, please use "+t+" instead.")}function g(e){return"[object Object]"===Object.prototype.toString.call(e)}function C(e){return g(e)?Object.keys(e).reduce((function(t,r){var n=g(e[r]),i=n?C(e[r]):e[r],o=n&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,c({},r,i))}),{}):e}function S(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?S(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((function(t){S(e,e.get(t),r)}))})))}function T(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(r){r.type===n&&r.trackId===t.id&&S(e,r,i)}))})),i}var R={};function b(e){if(Array.isArray(e))return e}function P(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function k(e,t){if(e){if("string"==typeof e)return M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,t):void 0}}function _(e,t){return b(e)||P(e)||k(e,t)||w()}e(R,"shimMediaStream",(function(){return O})),e(R,"shimOnTrack",(function(){return I})),e(R,"shimGetSendersWithDtmf",(function(){return j})),e(R,"shimGetStats",(function(){return A})),e(R,"shimSenderReceiverGetStats",(function(){return L})),e(R,"shimAddTrackRemoveTrackWithNative",(function(){return N})),e(R,"shimAddTrackRemoveTrack",(function(){return U})),e(R,"shimPeerConnection",(function(){return F})),e(R,"fixNegotiationNeeded",(function(){return B})),e(R,"shimGetUserMedia",(function(){return x})),e(R,"shimGetDisplayMedia",(function(){return D}));var E=v;function x(e,t){var r=e&&e.navigator;if(r.mediaDevices){var n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var o={};"number"==typeof n.ideal?(o[i("min",r)]=n.ideal,t.optional.push(o),(o={})[i("max",r)]=n.ideal,t.optional.push(o)):(o[i("",r)]=n.ideal,t.optional.push(o))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){var a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});var s,c=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||c))if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?s=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(s=["front"]),s)return r.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return s.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&s.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=a.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),E("chrome: "+JSON.stringify(e)),i(e)}));e.video=n(e.video)}return E("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=function(e,t,n){i(e,(function(e){r.webkitGetUserMedia(e,t,(function(e){n&&n(o(e))}))}))}.bind(r),r.mediaDevices.getUserMedia){var a=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return i(e,(function(e){return a(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(o(e))}))}))}}}}function D(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var n=r.video&&r.video.width,i=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function O(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function I(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)})),t.stream.getTracks().forEach((function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n};var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else h(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function j(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function A(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=_(arguments,3),n=r[0],i=r[1],o=r[2];if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){return t.apply(this,[function(e){i(s(a(e)))},n])}return new Promise((function(r,n){t.apply(e,[function(e){r(s(a(e)))},n])})).then(i,o)}}}function L(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return T(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),h(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return T(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,o=arguments[0];return this.getSenders().forEach((function(e){e.track===o&&(t?n=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===o&&(r?n=!0:r=e),e.track===o})),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function N(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),i.apply(this,arguments)}}function U(e,t){var r=function(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})};if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return N(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[r.id]=a,this._reverseStreams[a.id]=r,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=c({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var i=r(e,n);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return r(e,t)}))}));e.RTCPeerConnection.prototype[t]=i[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,r=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})),a.apply(this,arguments)):a.apply(this,arguments);var e,t,r};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:r(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(n){r._streams[n].getTracks().find((function(t){return e.track===t}))&&(t=r._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}}function F(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=c({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}))}function B(e,t){h(e,"negotiationneeded",(function(e){var r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))}var G={};function z(e){if(Array.isArray(e))return M(e)}function V(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function J(e){return z(e)||P(e)||k(e)||V()}function W(e,t){var r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){y("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},n&&n.prototype.getSettings){var a=n.prototype.getSettings;n.prototype.getSettings=function(){var e=a.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var s=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}}function K(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function q(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function H(e,t){if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=c({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}));var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=_(arguments,3),i=e[0],o=e[1],a=e[2];return n.apply(this,[i||null]).then((function(e){if(t.version<53&&!o)try{e.forEach((function(e){e.type=r[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(o,a)}}}function $(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function X(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r}),h(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function Y(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;y("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})}function Q(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Z(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]);var r=(e=J(e)).length>0;r&&e.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var n=t.apply(this,arguments);if(r){var i=n.sender,o=i.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===Object.keys(o.encodings[0]).length)&&(o.encodings=e,i.sendEncodings=e,this.setParametersPromises.push(i.setParameters(o).then((function(){delete i.sendEncodings})).catch((function(){delete i.sendEncodings}))))}return n})}}function ee(e){if("object"==typeof e&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function te(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,arguments)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}}function re(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,arguments)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}}e(G,"shimOnTrack",(function(){return q})),e(G,"shimPeerConnection",(function(){return H})),e(G,"shimSenderGetStats",(function(){return $})),e(G,"shimReceiverGetStats",(function(){return X})),e(G,"shimRemoveStream",(function(){return Y})),e(G,"shimRTCDataChannel",(function(){return Q})),e(G,"shimAddTransceiver",(function(){return Z})),e(G,"shimGetParameters",(function(){return ee})),e(G,"shimCreateOffer",(function(){return te})),e(G,"shimCreateAnswer",(function(){return re})),e(G,"shimGetUserMedia",(function(){return W})),e(G,"shimGetDisplayMedia",(function(){return K}));var ne={};function ie(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(n){return t.call(r,n,e)})),e.getVideoTracks().forEach((function(n){return t.call(r,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=this;return n&&n.forEach((function(e){o._localStreams?o._localStreams.includes(e)||o._localStreams.push(e):o._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})}}function oe(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}}function ae(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=s,s=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=s,s=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=s}}function se(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return n(ce(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))}function ce(e){return e&&void 0!==e.video?Object.assign({},e,{video:C(e.video)}):e}function pe(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];void 0===o.urls&&o.url?(y("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function de(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function ue(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function fe(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}e(ne,"shimLocalStreamsAPI",(function(){return ie})),e(ne,"shimRemoteStreamsAPI",(function(){return oe})),e(ne,"shimCallbacksAPI",(function(){return ae})),e(ne,"shimGetUserMedia",(function(){return se})),e(ne,"shimConstraints",(function(){return ce})),e(ne,"shimRTCIceServerUrls",(function(){return pe})),e(ne,"shimTrackEventTransceiver",(function(){return de})),e(ne,"shimCreateOfferLegacy",(function(){return ue})),e(ne,"shimAudioContext",(function(){return fe}));var he={};e(he,"shimRTCIceCandidate",(function(){return ve})),e(he,"shimRTCIceCandidateRelayProtocol",(function(){return ye})),e(he,"shimMaxMessageSize",(function(){return ge})),e(he,"shimSendThrowTypeError",(function(){return Ce})),e(he,"shimConnectionState",(function(){return Se})),e(he,"removeExtmapAllowMixed",(function(){return Te})),e(he,"shimAddIceCandidateNullOrEmpty",(function(){return Re})),e(he,"shimParameterlessSetLocalDescription",(function(){return be}));var me={},le={};function ve(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var r=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){var n=new r(e),i=t(me).parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new r(e)},e.RTCIceCandidate.prototype=r.prototype,h(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function ye(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||h(e,"icecandidate",(function(e){if(e.candidate){var r=t(me).parseCandidate(e.candidate.candidate);"relay"===r.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return e}))}function ge(e,r){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,i;(this._sctp=null,"chrome"===r.browser&&r.version>=76)&&("plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}));if(function(e){if(!e||!e.sdp)return!1;var r=t(me).splitSections(e.sdp);return r.shift(),r.some((function(e){var r=t(me).parseMLine(e);return r&&"application"===r.kind&&-1!==r.protocol.indexOf("SCTP")}))}(arguments[0])){var o,a=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),s=(e=a,i=65536,"firefox"===r.browser&&(i=r.version<57?-1===e?16384:2147483637:r.version<60?57===r.version?65535:65536:2147483637),i),c=function(e,n){var i=65536;"firefox"===r.browser&&57===r.version&&(i=65535);var o=t(me).matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substring(19),10):"firefox"===r.browser&&-1!==n&&(i=2147483637),i}(arguments[0],a);o=0===s&&0===c?Number.POSITIVE_INFINITY:0===s||0===c?Math.max(s,c):Math.min(s,c);var p={};Object.defineProperty(p,"maxMessageSize",{get:function(){return o}}),this._sctp=p}return n.apply(this,arguments)}}}function Ce(e){var t=function(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}};if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);return t(e,this),e},h(e,"datachannel",(function(e){return t(e.channel,e.target),e}))}}function Se(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}}function Te(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var n=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return r.apply(this,arguments)}}}function Re(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}function be(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.setLocalDescription;r&&0!==r.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this,t=arguments[0]||{};if("object"!=typeof t||t.type&&t.sdp)return r.apply(this,arguments);if(!(t={type:t.type,sdp:t.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":t.type="offer";break;default:t.type="answer"}return t.sdp||"offer"!==t.type&&"answer"!==t.type?r.apply(this,[t]):("offer"===t.type?this.createOffer:this.createAnswer).apply(this).then((function(t){return r.apply(e,[t])}))})}}le.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},le.localCName=le.generateIdentifier(),le.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},le.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},le.getDescription=function(e){var t=le.splitSections(e);return t&&t[0]},le.getMediaSections=function(e){var t=le.splitSections(e);return t.shift(),t},le.matchPrefix=function(e,t){return le.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},le.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:void 0===r[t[n]]&&(r[t[n]]=t[n+1])}return r},le.writeCandidate=function(e){var t=[];t.push(e.foundation);var r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},le.parseIceOptions=function(e){return e.substring(14).split(" ")},le.parseRtpMap=function(e){var t=e.substring(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},le.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},le.parseExtmap=function(e){var t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},le.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},le.parseFmtp=function(e){for(var t,r={},n=e.substring(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},le.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},le.parseRtcpFb=function(e){var t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},le.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},le.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substring(7,t),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substring(t+1,n),r.value=e.substring(n+1)):r.attribute=e.substring(t+1),r},le.parseSsrcGroup=function(e){var t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},le.getMid=function(e){var t=le.matchPrefix(e,"a=mid:")[0];if(t)return t.substring(6)},le.parseFingerprint=function(e){var t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},le.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:le.matchPrefix(e+t,"a=fingerprint:").map(le.parseFingerprint)}},le.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},le.parseCryptoLine=function(e){var t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},le.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?le.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},le.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},le.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},le.getCryptoParameters=function(e,t){return le.matchPrefix(e+t,"a=crypto:").map(le.parseCryptoLine)},le.getIceParameters=function(e,t){var r=le.matchPrefix(e+t,"a=ice-ufrag:")[0],n=le.matchPrefix(e+t,"a=ice-pwd:")[0];return r&&n?{usernameFragment:r.substring(12),password:n.substring(10)}:null},le.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},le.parseRtpParameters=function(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=le.splitLines(e)[0].split(" ");t.profile=r[2];for(var n=3;n<r.length;n++){var i=r[n],o=le.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(o){var a=le.parseRtpMap(o),s=le.matchPrefix(e,"a=fmtp:"+i+" ");switch(a.parameters=s.length?le.parseFmtp(s[0]):{},a.rtcpFeedback=le.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(le.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}le.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(le.parseExtmap(e))}));var c=le.matchPrefix(e,"a=rtcp-fb:* ").map(le.parseRtcpFb);return t.codecs.forEach((function(e){c.forEach((function(t){e.rtcpFeedback.find((function(e){return e.type===t.type&&e.parameter===t.parameter}))||e.rtcpFeedback.push(t)}))})),t},le.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" "+(t.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){r+=le.writeRtpMap(e),r+=le.writeFmtp(e),r+=le.writeRtcpFb(e)}));var n=0;return t.codecs.forEach((function(e){e.maxptime>n&&(n=e.maxptime)})),n>0&&(r+="a=maxptime:"+n+"\r\n"),t.headerExtensions&&t.headerExtensions.forEach((function(e){r+=le.writeExtmap(e)})),r},le.parseRtpEncodingParameters=function(e){var t,r=[],n=le.parseRtpParameters(e),i=-1!==n.fecMechanisms.indexOf("RED"),o=-1!==n.fecMechanisms.indexOf("ULPFEC"),a=le.matchPrefix(e,"a=ssrc:").map((function(e){return le.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),s=a.length>0&&a[0].ssrc,c=le.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substring(17).split(" ").map((function(e){return parseInt(e,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===s&&(t=c[0][1]),n.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&t&&(n.rtx={ssrc:t}),r.push(n),i&&((n=JSON.parse(JSON.stringify(n))).fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},r.push(n))}})),0===r.length&&s&&r.push({ssrc:s});var p=le.matchPrefix(e,"b=");return p.length&&(p=0===p[0].indexOf("b=TIAS:")?parseInt(p[0].substring(7),10):0===p[0].indexOf("b=AS:")?950*parseInt(p[0].substring(5),10)-16e3:void 0,r.forEach((function(e){e.maxBitrate=p}))),r},le.parseRtcpParameters=function(e){var t={},r=le.matchPrefix(e,"a=ssrc:").map((function(e){return le.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=le.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=0===n.length;var i=le.matchPrefix(e,"a=rtcp-mux");return t.mux=i.length>0,t},le.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},le.parseMsid=function(e){var t,r=le.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substring(7).split(" "))[0],track:t[1]};var n=le.matchPrefix(e,"a=ssrc:").map((function(e){return le.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return n.length>0?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},le.parseSctpDescription=function(e){var t,r=le.parseMLine(e),n=le.matchPrefix(e,"a=max-message-size:");n.length>0&&(t=parseInt(n[0].substring(19),10)),isNaN(t)&&(t=65536);var i=le.matchPrefix(e,"a=sctp-port:");if(i.length>0)return{port:parseInt(i[0].substring(12),10),protocol:r.fmt,maxMessageSize:t};var o=le.matchPrefix(e,"a=sctpmap:");if(o.length>0){var a=o[0].substring(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},le.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},le.generateSessionId=function(){return Math.random().toString().substr(2,22)},le.writeSessionBoilerplate=function(e,t,r){var n=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||le.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},le.getDirection=function(e,t){for(var r=le.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substring(2)}return t?le.getDirection(t):"sendrecv"},le.getKind=function(e){return le.splitLines(e)[0].split(" ")[0].substring(2)},le.isRejected=function(e){return"0"===e.split(" ",2)[1]},le.parseMLine=function(e){var t=le.splitLines(e)[0].substring(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},le.parseOLine=function(e){var t=le.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},le.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=le.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},me=le;var Pe,we,Me,ke,_e=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},r=v,n=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var r=e.navigator;if(r.mozGetUserMedia)t.browser="firefox",t.version=f(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=f(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=f(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:n,commonShim:he,extractVersion:f,disableLog:m,disableWarnings:l,sdp:me};switch(n.browser){case"chrome":if(!R||!R.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;if(null===n.version)return r("Chrome shim can not determine version, not shimming."),i;r("adapter.js shimming chrome."),i.browserShim=R,he.shimAddIceCandidateNullOrEmpty(e,n),he.shimParameterlessSetLocalDescription(e,n),R.shimGetUserMedia(e,n),R.shimMediaStream(e,n),R.shimPeerConnection(e,n),R.shimOnTrack(e,n),R.shimAddTrackRemoveTrack(e,n),R.shimGetSendersWithDtmf(e,n),R.shimGetStats(e,n),R.shimSenderReceiverGetStats(e,n),R.fixNegotiationNeeded(e,n),he.shimRTCIceCandidate(e,n),he.shimRTCIceCandidateRelayProtocol(e,n),he.shimConnectionState(e,n),he.shimMaxMessageSize(e,n),he.shimSendThrowTypeError(e,n),he.removeExtmapAllowMixed(e,n);break;case"firefox":if(!G||!G.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),i.browserShim=G,he.shimAddIceCandidateNullOrEmpty(e,n),he.shimParameterlessSetLocalDescription(e,n),G.shimGetUserMedia(e,n),G.shimPeerConnection(e,n),G.shimOnTrack(e,n),G.shimRemoveStream(e,n),G.shimSenderGetStats(e,n),G.shimReceiverGetStats(e,n),G.shimRTCDataChannel(e,n),G.shimAddTransceiver(e,n),G.shimGetParameters(e,n),G.shimCreateOffer(e,n),G.shimCreateAnswer(e,n),he.shimRTCIceCandidate(e,n),he.shimConnectionState(e,n),he.shimMaxMessageSize(e,n),he.shimSendThrowTypeError(e,n);break;case"safari":if(!ne||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),i.browserShim=ne,he.shimAddIceCandidateNullOrEmpty(e,n),he.shimParameterlessSetLocalDescription(e,n),ne.shimRTCIceServerUrls(e,n),ne.shimCreateOfferLegacy(e,n),ne.shimCallbacksAPI(e,n),ne.shimLocalStreamsAPI(e,n),ne.shimRemoteStreamsAPI(e,n),ne.shimTrackEventTransceiver(e,n),ne.shimGetUserMedia(e,n),ne.shimAudioContext(e,n),he.shimRTCIceCandidate(e,n),he.shimRTCIceCandidateRelayProtocol(e,n),he.shimMaxMessageSize(e,n),he.shimSendThrowTypeError(e,n),he.removeExtmapAllowMixed(e,n);break;default:r("Unsupported browser!")}return i}({window:"undefined"==typeof window?void 0:window}),Ee=_e,xe=Ee.default||Ee,De=new((Pe=function(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}).prototype.isAudioContextSupported=function(){return"undefined"!=typeof AudioContext},Pe.prototype.isMediaDevicesSupported=function(){return void 0!==navigator.mediaDevices},Pe.prototype.isGetUserMediaSupported=function(){return this.isMediaDevicesSupported()&&void 0!==navigator.mediaDevices.getUserMedia},Pe.prototype.isMediaRecorderSupported=function(){return"undefined"!=typeof MediaRecorder},Pe.prototype.isAudioWorkletNode=function(){return"undefined"!=typeof AudioWorkletNode},Pe.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},Pe.prototype.getBrowser=function(){return xe.browserDetails.browser},Pe.prototype.getVersion=function(){return xe.browserDetails.version||0},Pe.prototype.isUnifiedPlanSupported=function(){var e=this.getBrowser(),t=xe.browserDetails.version||0;return!("chrome"===e&&t<this.minChromeVersion)&&("firefox"===e&&t>=this.minFirefoxVersion||!!(this.isAudioContextSupported()&&this.isMediaDevicesSupported()&&this.isGetUserMediaSupported()&&this.isMediaRecorderSupported()&&this.isAudioWorkletNode()))},Pe.prototype.toString=function(){return"Supports:\n    browser:".concat(this.getBrowser(),"\n    version:").concat(this.getVersion(),"\n    isIOS:").concat(this.isIOS,"\n    isAudioContextSupported:").concat(this.isAudioContextSupported(),"\n\tisMediaDevicesSupported:").concat(this.isMediaDevicesSupported(),"\n\tisGetUserMediaSupported:").concat(this.isGetUserMediaSupported(),"\n\tisMediaRecorderSupported:").concat(this.isMediaRecorderSupported(),"\n    isBrowserSupported:").concat(this.isBrowserSupported(),"\n\tisAudioWorkletNode:").concat(this.isAudioWorkletNode(),"\n    isUnifiedPlanSupported:").concat(this.isUnifiedPlanSupported(),"\n\t")},Pe),Oe=(we=function(e,t){return we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},we(e,t)},function(e,t){var r=function(){this.constructor=e};if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");we(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Ie=function(){return Ie=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ie.apply(this,arguments)},je=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){var a=function(e){try{c(n.next(e))}catch(e){o(e)}},s=function(e){try{c(n.throw(e))}catch(e){o(e)}},c=function(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)};c((n=n.apply(e,t||[])).next())}))},Ae=function(e,t){var r,n,i,o,a=function(e){return function(t){return s([e,t])}},s=function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(c=0)),c;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,n=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(i=c.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){c=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){c.label=a[1];break}if(6===a[0]&&c.label<i[1]){c.label=i[1],i=a;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(a);break}i[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(e,c)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}},c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},Le=(Oe(ke=function(e,t){var r=Me.call(this)||this;return r.mediaStream=null,r.mediaRecorder=null,r.mediaBlobs=[],r.soundMeter=null,r.mediaState="inactive",r.mediaStreamConstraints=null,r.mediaRecorderOptions=null,r.timeSlice=null,De.isUnifiedPlanSupported()?r.setMediaType(e).setConfig(t):r.emit("error",{type:"constructor",message:"".concat(De.toString())}),r},Me=a),ke.prototype.setConfig=function(e){switch(this.mediaType){case"audio":this.setAudioConfig(e);break;case"video":this.setVideoConfig(e);break;case"screen":this.setScreenConfig(e)}return this},ke.prototype.getAudioConstraints=function(e){var t=e||{},r=t.audio,n=t.sampleRate,i=t.echoCancellation;return void 0===n&&void 0===i?r||(r=!0):(r={},n&&(r.sampleRate=n),i&&(r.echoCancellation={exact:i})),r},ke.prototype.getVideoConstraints=function(e){var t=e||{},r=t.video,n=t.sampleRate,i=t.width,o=t.height;return void 0===n&&void 0===i&&void 0===o?r||(r=!0):(r={},n&&(r.sampleRate=n),i&&(r.width=i),o&&(r.height=o)),r},ke.prototype.getConfigOptions=function(e){var t,r=e||{},n=r.mimeType,i=r.audioBitsPerSecond,o=r.videoBitsPerSecond,a={mimeType:n||(null===(t=this.getSupportedMimeTypes())||void 0===t?void 0:t[0])};return i&&(a.audioBitsPerSecond=i),o&&(a.videoBitsPerSecond=o),a},ke.prototype.setAudioConfig=function(e){var t=this.getAudioConstraints(e),r=this.getConfigOptions(e);return this.setMediaStreamConstraints({audio:t}).setMediaRecorderOptions(r).setTimeSlice(null==e?void 0:e.timeSlice),this},ke.prototype.setVideoConfig=function(e){var t=this.getAudioConstraints(e),r=this.getVideoConstraints(e),n=this.getConfigOptions(e);return this.setMediaStreamConstraints({video:r,audio:t}).setMediaRecorderOptions(n).setTimeSlice(null==e?void 0:e.timeSlice),this},ke.prototype.setScreenConfig=function(e){var t=this.getAudioConstraints(e),r=this.getVideoConstraints(e),n=this.getConfigOptions(e);return this.setMediaStreamConstraints({video:r,audio:t}).setMediaRecorderOptions(n).setTimeSlice(null==e?void 0:e.timeSlice),this},ke.prototype.setTimeSlice=function(e){return e&&(this.timeSlice=e),this},ke.prototype.getTimeSlice=function(){return this.timeSlice},ke.prototype.getMediaType=function(){return this.mediaType},ke.prototype.setMediaType=function(e){return this.mediaType=e,this},ke.prototype.getMedisStream=function(){return this.mediaStream},ke.prototype.setMediaStream=function(e){return je(this,void 0,void 0,(function(){var t,r,n,i,o;return Ae(this,(function(a){switch(a.label){case 0:this.setMediaStreamConstraints(e),t=this.getMediaStreamConstraints(),r=this.getMediaType(),this.setMediaState("wait"),a.label=1;case 1:return a.trys.push([1,6,,7]),n=this,"screen"!==r?[3,3]:[4,navigator.mediaDevices.getDisplayMedia(t)];case 2:return i=a.sent(),[3,5];case 3:return[4,navigator.mediaDevices.getUserMedia(t)];case 4:i=a.sent(),a.label=5;case 5:return n.mediaStream=i,this.setMediaState("ready"),this.setSoundMeter(),[2,this];case 6:return o=a.sent(),this.setMediaState("inactive"),this.emit("error",{type:"setMedisStream",message:o}),[3,7];case 7:return[2]}}))}))},ke.prototype.getMediaRecorder=function(){return this.mediaRecorder},ke.prototype.setMediaRecorder=function(e){var t=this;return this.setMediaRecorderOptions(e),this.mediaRecorder=new MediaRecorder(this.mediaStream,this.getMediaRecorderOptions()),this.mediaRecorder.onerror=function(e){t.emit("error",{type:"mediaRecorder",message:e})},this.mediaRecorder.ondataavailable=function(e){t.emit("dataavailable",e),t.mediaBlobs.push(e.data)},this.mediaRecorder.onstart=function(e){t.mediaBlobs=[],t.emit("start",e)},this.mediaRecorder.onstop=function(e){t.soundMeter.stop(),t.emit("stop",e)},this.mediaRecorder.onpause=function(e){t.emit("pause",e)},this.mediaRecorder.onresume=function(e){t.emit("resume",e)},this},ke.prototype.getMediaBlobs=function(){return this.mediaBlobs},ke.prototype.getMediaState=function(){return this.mediaState},ke.prototype.setMediaState=function(e){return this.mediaState=e,this},ke.prototype.getRecorderState=function(){var e;return(null===(e=this.getMediaRecorder())||void 0===e?void 0:e.state)||"inactive"},ke.prototype.getMediaStreamConstraints=function(){return this.mediaStreamConstraints},ke.prototype.setMediaStreamConstraints=function(e){var t=Ie(Ie({},this.getMediaStreamConstraints()),e);return this.mediaStreamConstraints=t,this},ke.prototype.getMediaRecorderOptions=function(){return this.mediaRecorderOptions},ke.prototype.setMediaRecorderOptions=function(e){var t=Ie(Ie({},this.getMediaRecorderOptions()),e);return this.mediaRecorderOptions=t,this},ke.prototype.isReady=function(e){void 0===e&&(e="isReady");var t=this.getMediaState();if("ready"===t)return!0;var r="the cureent mediaState is ".concat(t,", Please use open function");return this.emit("error",{type:e,message:r}),!1},ke.prototype.onerror=function(e){return e&&this.on("error",e),this},ke.prototype.create=function(){return je(this,void 0,void 0,(function(){return Ae(this,(function(e){switch(e.label){case 0:return"inactive"!==this.getMediaState()?[3,2]:[4,this.setMediaStream()];case 1:return e.sent()&&(this.setMediaRecorder(),this.emit("create")),[2,this];case 2:this.emit("error",{type:"create",message:"mediaState: ".concat(this.getMediaState())}),e.label=3;case 3:return[2]}}))}))},ke.prototype.oncreate=function(e){return e&&this.on("create",e),this},ke.prototype.destroy=function(){var e;if("inactive"!==this.getMediaState())return"inactive"!==this.getRecorderState()&&this.stop(),null===(e=this.mediaStream)||void 0===e||e.getTracks().forEach((function(e){return e.stop()})),this.mediaBlobs=[],this.mediaStream=null,this.mediaRecorder=null,this.setMediaState("inactive"),this.emit("destroy"),this;this.emit("error",{type:"destroy",message:"mediaState: ".concat(this.getMediaState())})},ke.prototype.ondestroy=function(e){return e&&this.on("destroy",e),this},ke.prototype.ondataavailable=function(e){return e&&this.on("dataavailable",e),this},ke.prototype.start=function(e){var t,r;if(!this.isReady())return this;try{return this.setTimeSlice(e),(e=this.getTimeSlice())?null===(t=this.mediaRecorder)||void 0===t||t.start(e):null===(r=this.mediaRecorder)||void 0===r||r.start(),this}catch(e){this.emit("error",{type:"start",message:e})}},ke.prototype.onstart=function(e){e&&this.on("start",e)},ke.prototype.stop=function(){var e;if(!this.isReady())return this;try{return null===(e=this.mediaRecorder)||void 0===e||e.stop(),this}catch(e){this.emit("error",{type:"stop",message:e})}},ke.prototype.onstop=function(e){return e&&this.on("stop",e),this},ke.prototype.pause=function(){var e;if(!this.isReady())return this;try{return null===(e=this.mediaRecorder)||void 0===e||e.pause(),this}catch(e){this.emit("error",{type:"pause",message:e})}},ke.prototype.onpause=function(e){return e&&this.on("pause",e),this},ke.prototype.resume=function(){var e;if(!this.isReady())return this;try{return null===(e=this.mediaRecorder)||void 0===e||e.resume(),this}catch(e){this.emit("error",{type:"resume",message:e})}},ke.prototype.onresume=function(e){return e&&this.on("resume",e),this},ke.prototype.setSoundMeter=function(e){try{var t=new AudioContext;return this.soundMeter=new s(t),this.soundMeter.connectToSource(e||this.mediaStream),this}catch(e){this.emit("error",{type:"setSoundMeter",message:e})}},ke.prototype.getSoundMeter=function(){return this.soundMeter},ke.prototype.getBlob=function(e){if(this.isReady()){var t=this.getMediaRecorderOptions().mimeType;return e||(e={type:t}),new Blob(this.mediaBlobs,e)}},ke.prototype.getBlobUrl=function(e){if(this.isReady())try{var t=this.getBlob(e);return URL.createObjectURL(t)}catch(e){this.emit("error",{type:"getBlobUrl",message:e})}},ke.prototype.downloadBlob=function(e){var t=this.getBlobUrl(),r=document.createElement("a");return r.style.display="none",r.href=t,r.download="".concat(e||"mediajs",".webm"),document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r),window.URL.revokeObjectURL(t)}),150),this},ke.prototype.getDuration=function(e){var t=this;return new Promise((function(r,n){e=e||t.getBlob();var i=t,o=new AudioContext,a=new FileReader;a.onload=function(){var e=this.result;o.decodeAudioData(e,(function(e){var t=Math.round(1e3*e.duration);r(t)}),(function(e){i.emit("error","getDuration","getDuration function is err"),n(e)}))},e?a.readAsArrayBuffer(e):i.emit("error","getDuration","blob is Empty")}))},ke.prototype._enumerateDevices=function(){return je(this,void 0,void 0,(function(){var e;return Ae(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,navigator.mediaDevices.enumerateDevices()];case 1:return[2,t.sent()];case 2:return e=t.sent(),this.emit("error",{type:"_enumerateDevices",message:e}),[3,3];case 3:return[2]}}))}))},ke.prototype.getSupportedMimeTypes=function(){var e="audio"===this.mediaType?"audio":"video",t=["vp9","vp9.0","vp8","vp8.0","avc1","av1","h265","h264"],r=[],n=MediaRecorder.isTypeSupported;return["webm","mp4","ogg","mov","avi","wmv","flv","mkv","ts","x-matroska"].forEach((function(i){var o="".concat(e,"/").concat(i);t.forEach((function(e){return["".concat(o,";codecs=").concat(e),"".concat(o,";codecs=").concat(e.toUpperCase())].forEach((function(e){n(e)&&r.push(e)}))})),n(o)&&r.push(o)})),r},ke.prototype._isTypeSupported=function(e){return MediaRecorder.isTypeSupported(e)},ke.prototype.getVideoTracks=function(e){return(e=e||this.mediaStream).getVideoTracks()},ke.prototype.connectVideo=function(e){return e.srcObject=this.mediaStream,this},ke.prototype.connectAudio=function(e){return e.srcObject=this.mediaStream,this},ke.prototype.snapshot=function(e,t){return e.width=t.videoWidth,e.height=t.videoHeight,e.getContext("2d").drawImage(t,0,0,e.width,e.height),this},ke);var Ne;r.Media;Ne=JSON.parse('{"name":"mediajs","version":"1.0.0","keywords":["mediajs","webrtc","adapter","audio","video","screen"],"description":"MediaJS is a JavaScript library that can record audio, video and screen ","homepage":"https://mediajs.com","bugs":{"url":"https://github.com/027xiguapi/mediajs/issues"},"repository":{"type":"git","url":"https://github.com/027xiguapi/mediajs"},"license":"MIT","contributors":["027xiguapi <458813868@qq.com>"],"files":["dist/*"],"sideEffects":["src/global.ts","src/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/mediajs.global.min.js","browser-unminified":"dist/mediajs.global.js","types":"dist/types.d.ts","engines":{"node":">= 18"},"targets":{"types":{"source":"src/exports.ts"},"main":{"source":"src/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"src/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"cover 99%, not dead"},"source":"src/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"cover 99%, not dead"},"source":"src/global.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit","watch":"parcel watch","build":"rimraf dist && parcel build","prepublishOnly":"npm run build","format":"prettier --write .","semantic-release":"semantic-release","mocha":"mocha --timeout 5000 \'examples/src/content/**/test.js\'"},"devDependencies":{"@parcel/config-default":"^2.8.1","@parcel/packager-ts":"^2.8.1","@parcel/transformer-typescript-tsc":"^2.8.1","@parcel/transformer-typescript-types":"^2.8.1","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","chai":"^4.3.7","mocha":"^10.2.0","parcel":"^2.8.1","parcel-transformer-tsc-sourcemaps":"^1.0.2","prettier":"^2.6.2","selenium-webdriver":"^4.8.2","semantic-release":"^20.0.0","typescript":"^4.5.5"},"dependencies":{"@swc/helpers":"^0.4.0","webrtc-adapter":"^8.0.0"}}'),window.mediajs={audio:function(e){return new(0,r.Media)("audio",e)},video:function(e){return new(0,r.Media)("video",e)},screen:function(e){return new(0,r.Media)("screen",e)},Env:De,version:Ne.version}}();
//# sourceMappingURL=mediajs.global.min.js.map
