{"mappings":"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,MAAA,CAClC,IAAI,CAAC,kBAAkB,IAAE,0BAAA,MAAA,CAC5B,IAAI,CAAC,kBAAkB,IAAE,iCAAA,MAAA,CAClB,IAAI,CAAC,sBAAsB,IAAE;IAEzD;IACD,OAAA;AAAA,GAzFwB;;;A,I,kC,a,U,S,I,A,W;I,I,gB,S,e,C,E,C,E;Q,gB,O,c,I,C;Y,W,E;Q,C,a,S,S,C,E,C,E;Y,E,S,G;Q,K,S,C,E,C,E;Y,I,I,K,E,I,O,S,C,c,C,I,C,G,I,C,C,E,G,C,C,E;Q;Q,O,c,G;I;I,O,S,C,E,C,E;Y,K,S,K;Y,I,C,W,G;Q;Q,I,O,M,c,M,I,E,M,I,U,yB,O,K,iC;Q,c,G;Q,E,S,G,M,I,G,O,M,C,K,C,G,S,G,E,S,E,I,I,A,C;I;A;A,I,iC,a,U,Q,I,W;I,iC,O,M,I,S,C,E;Q,I,I,G,I,G,I,U,M,E,I,G,I;Y,I,S,C,E;Y,I,I,K,E,I,O,S,C,c,C,I,C,G,I,C,C,E,G,C,C,E;Q;Q,O;I;I,O,+B,K,C,I,E;A;A,I,kC,a,U,S,I,S,O,E,U,E,C,E,S,E;Q,Q,S,M,K,E;Q,O,iB,I,Q,I,E,S,O,E;Y,Q;Q,E;I;I,O,I,C,K,C,I,O,C,E,S,O,E,M,E;Y,Y,S,U,K,E;Y,I;gB,K,U,I,C;Y,E,O,G;gB,O;Y;Q;Y,W,S,S,K,E;Y,I;gB,K,S,C,Q,C;Y,E,O,G;gB,O;Y;Q;Y,O,S,K,M,E;Y,O,I,G,Q,O,K,I,M,O,K,E,I,C,W,S;Q;Q,K,A,C,Y,U,K,C,S,c,E,C,E,I;I;A;A,I,oC,a,U,W,I,S,O,E,I,E;Q,O,S,K,C,E;Q,O,S,C,E;Y,O,K;gB;gB;a;Q;I;Q,O,S,K,E,E;Q,I,G,M,I,U,mC;Q,M,K,C,I,G,E,C,E,I,C,I,C,C,A,G,C,C,I;Y,I,I,G,K,C,I,E,C,E,G,I,C,C,S,G,E,C,E,G,C,C,Q,I,C,A,C,I,C,C,S,A,K,E,I,C,I,C,A,I,E,I,A,K,C,A,C,I,E,I,C,G,E,C,E,C,E,I,E,O;Y,I,I,G,C,E,K;gB,E,C,E,G;gB,E,K;a;Y,O,E,C,E;gB,K;gB,K;oB,I;oB,K;gB,K;oB,E,K;oB,O;wB,O,E,C,E;wB,M,K;oB;gB,K;oB,E,K;oB,I,E,C,E;oB,K;wB;qB;oB,Q;gB,K;oB,K,E,G,C,G;oB,E,I,C,G;oB,Q;gB;oB,I,C,C,I,E,I,E,I,E,M,G,K,C,C,E,M,G,E,A,K,C,E,C,E,K,K,E,C,E,K,C,G;wB,I;wB,Q;oB,C;oB,I,E,C,E,K,K,C,C,K,E,C,E,G,C,C,E,I,E,C,E,G,C,C,E,G;wB,E,K,G,E,C,E;wB,K;oB,C;oB,I,E,C,E,K,K,E,K,G,C,C,E,E;wB,E,K,G,C,C,E;wB,I;wB,K;oB,C;oB,I,K,E,K,G,C,C,E,E;wB,E,K,G,C,C,E;wB,E,G,C,I,C;wB,K;oB,C;oB,I,C,C,E,E,E,G,C,G;oB,E,I,C,G;oB,Q;Y;Y,K,K,I,C,S;Q,E,O,G;Y,K;gB;gB;a;Y,I;Q,S;Y,I,I;Q;Q,I,E,C,E,G,G,M,E,C,E,C;Q,O;Y,O,E,C,E,G,E,C,E,G,K,C;Y,M,I;Q;I;I,I,I;Q,O;Q,M,S,O;Y,I,C,C,E,G,G,M,C,C,E,C;Y,O,C,C,E;Q;Q,M,E;Q,K,E;I,G,G,G,G;I,O,I;Q,M,K;Q,S,K;Q,U,K;I,G,O,W,c,C,C,C,O,Q,C,G,W;Q,O,I;I,C,G,C;A;AHKxB,IAAA,4CAAA,WAAA,GAAA,SAAA,MAAA,EAAA;QAmBC,QAAA,SAAA,MACC,SAAoB,EACpB,MAAiD,EAFlD;QAAA,IAAA,UAIC,OAAA,IAAA,CAAA,IAAA,KAAO,IAAA;QAtBA,QAAA,WAAW,GAAuB,IAAI;QAEtC,QAAA,aAAa,GAAyB,IAAI;QAE1C,QAAA,UAAU,GAAW,EAAE;QAEvB,QAAA,UAAU,GAAsB,IAAI;QAEpC,QAAA,UAAU,GAAe;QAEzB,QAAA,sBAAsB,GAAkC,IAAI;QAE5D,QAAA,oBAAoB,GAAgC,IAAI;QAIxD,QAAA,SAAS,GAAkB,IAAI;QAOtC,IAAI,CAAA,GAAA,yCAAA,EAAI,sBAAsB,IAC7B,QAAK,YAAY,CAAC,WAAW,SAAS,CAAC;aAEvC,QAAK,IAAI,CAAC,SAAS;YAAE,MAAM;YAAe,SAAS,GAAA,MAAA,CAAG,CAAA,GAAA,yCAAA,EAAI,QAAQ;QAAI;Q,O;IAExE;IA7BmB,gCAAA,OAAA;IA+BnB,MAAA,SAAA,CAAA,SAAS,GAAT,SAA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","sources":["src/global.ts","src/exports.ts","src/media.ts","src/eventTarget.ts","src/soundMeter.ts","src/env.ts","node_modules/webrtc-adapter/src/js/adapter_core.js","node_modules/webrtc-adapter/src/js/adapter_factory.js","node_modules/webrtc-adapter/src/js/utils.js","node_modules/@swc/helpers/src/_define_property.mjs","node_modules/@swc/helpers/src/_type_of.mjs","node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","node_modules/@swc/helpers/src/_sliced_to_array.mjs","node_modules/@swc/helpers/src/_array_with_holes.mjs","node_modules/@swc/helpers/src/_iterable_to_array.mjs","node_modules/@swc/helpers/src/_non_iterable_rest.mjs","node_modules/@swc/helpers/src/_unsupported_iterable_to_array.mjs","node_modules/@swc/helpers/src/_array_like_to_array.mjs","node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","node_modules/@swc/helpers/src/_to_consumable_array.mjs","node_modules/@swc/helpers/src/_array_without_holes.mjs","node_modules/@swc/helpers/src/_non_iterable_spread.mjs","node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","node_modules/webrtc-adapter/src/js/safari/safari_shim.js","node_modules/webrtc-adapter/src/js/common_shim.js","node_modules/sdp/sdp.js","package.json"],"sourcesContent":["import { audio, video, screen } from \"./exports\";\r\nimport { Env } from \"./env\";\r\nimport { version } from \"../package.json\";\r\n\r\n(<any>window).mediajs = {\r\n\taudio,\r\n\tvideo,\r\n\tscreen,\r\n\tEnv,\r\n\tversion,\r\n};\r\n/** @deprecated Should use mediajs namespace */\r\n","import { Media } from \"./media\";\r\nimport type { AudioOption, VideoOption, ScreenOption } from \"./type\";\r\n\r\nfunction audio(option?: AudioOption) {\r\n\tconst audio = new Media(\"audio\", option);\r\n\r\n\treturn audio;\r\n}\r\n\r\nfunction video(option?: VideoOption) {\r\n\tconst video = new Media(\"video\", option);\r\n\treturn video;\r\n}\r\n\r\nfunction screen(option?: ScreenOption) {\r\n\tconst screen = new Media(\"screen\", option);\r\n\treturn screen;\r\n}\r\n\r\nexport { audio, video, screen };\r\nexport default Media;\r\n","import EventTarget from \"./eventTarget\";\r\nimport SoundMeter from \"./soundMeter\";\r\nimport { Env } from \"./env\";\r\nimport type {\r\n\tMediaType,\r\n\tMediaState,\r\n\tAudioOption,\r\n\tVideoOption,\r\n\tScreenOption,\r\n} from \"./type\";\r\n\r\nclass Media extends EventTarget {\r\n\tprivate mediaStream: MediaStream | null = null;\r\n\r\n\tprivate mediaRecorder: MediaRecorder | null = null;\r\n\r\n\tprivate mediaBlobs: Blob[] = [];\r\n\r\n\tprivate soundMeter: SoundMeter | null = null;\r\n\r\n\tprivate mediaState: MediaState = \"inactive\";\r\n\r\n\tprivate mediaStreamConstraints: MediaStreamConstraints | null = null;\r\n\r\n\tprivate mediaRecorderOptions: MediaRecorderOptions | null = null;\r\n\r\n\tprivate mediaType: MediaType;\r\n\r\n\tprivate timeSlice: number | null = null;\r\n\r\n\tconstructor(\r\n\t\tmediaType: MediaType,\r\n\t\toption?: AudioOption | VideoOption | ScreenOption,\r\n\t) {\r\n\t\tsuper();\r\n\t\tif (Env.isUnifiedPlanSupported()) {\r\n\t\t\tthis.setMediaType(mediaType).setConfig(option);\r\n\t\t} else {\r\n\t\t\tthis.emit(\"error\", { type: \"constructor\", message: `${Env.toString()}` });\r\n\t\t}\r\n\t}\r\n\r\n\tsetConfig(option?: AudioOption | VideoOption | ScreenOption) {\r\n\t\tswitch (this.mediaType) {\r\n\t\t\tcase \"audio\":\r\n\t\t\t\tthis.setAudioConfig(option);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"video\":\r\n\t\t\t\tthis.setVideoConfig(option);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"screen\":\r\n\t\t\t\tthis.setScreenConfig(option);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetAudioConstraints(option) {\r\n\t\tlet { audio, sampleRate, echoCancellation } = option || {};\r\n\r\n\t\tif (\r\n\t\t\ttypeof sampleRate === \"undefined\" &&\r\n\t\t\ttypeof echoCancellation === \"undefined\"\r\n\t\t) {\r\n\t\t\taudio || (audio = true);\r\n\t\t} else {\r\n\t\t\taudio = {};\r\n\t\t\tsampleRate && (audio[\"sampleRate\"] = sampleRate);\r\n\t\t\techoCancellation &&\r\n\t\t\t\t(audio[\"echoCancellation\"] = { exact: echoCancellation });\r\n\t\t}\r\n\r\n\t\treturn audio;\r\n\t}\r\n\r\n\tgetVideoConstraints(option) {\r\n\t\tlet { video, sampleRate, width, height } = option || {};\r\n\r\n\t\tif (\r\n\t\t\ttypeof sampleRate === \"undefined\" &&\r\n\t\t\ttypeof width === \"undefined\" &&\r\n\t\t\ttypeof height === \"undefined\"\r\n\t\t) {\r\n\t\t\tvideo || (video = true);\r\n\t\t} else {\r\n\t\t\tvideo = {};\r\n\t\t\tsampleRate && (video[\"sampleRate\"] = sampleRate);\r\n\t\t\twidth && (video[\"width\"] = width);\r\n\t\t\theight && (video[\"height\"] = height);\r\n\t\t}\r\n\r\n\t\treturn video;\r\n\t}\r\n\r\n\tgetConfigOptions(option) {\r\n\t\tlet { mimeType, audioBitsPerSecond, videoBitsPerSecond } = option || {};\r\n\t\tlet options = {\r\n\t\t\tmimeType: mimeType || this.getSupportedMimeTypes()?.[0],\r\n\t\t};\r\n\t\taudioBitsPerSecond && (options[\"audioBitsPerSecond\"] = audioBitsPerSecond);\r\n\t\tvideoBitsPerSecond && (options[\"videoBitsPerSecond\"] = videoBitsPerSecond);\r\n\r\n\t\treturn options;\r\n\t}\r\n\r\n\tsetAudioConfig(option: AudioOption) {\r\n\t\tlet audio = this.getAudioConstraints(option);\r\n\t\tlet options = this.getConfigOptions(option);\r\n\r\n\t\tthis.setMediaStreamConstraints({ audio })\r\n\t\t\t.setMediaRecorderOptions(options)\r\n\t\t\t.setTimeSlice(option?.timeSlice);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetVideoConfig(option: VideoOption) {\r\n\t\tlet audio = this.getAudioConstraints(option);\r\n\t\tlet video = this.getVideoConstraints(option);\r\n\t\tlet options = this.getConfigOptions(option);\r\n\r\n\t\tthis.setMediaStreamConstraints({ video, audio })\r\n\t\t\t.setMediaRecorderOptions(options)\r\n\t\t\t.setTimeSlice(option?.timeSlice);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetScreenConfig(option: ScreenOption) {\r\n\t\tlet audio = this.getAudioConstraints(option);\r\n\t\tlet video = this.getVideoConstraints(option);\r\n\t\tlet options = this.getConfigOptions(option);\r\n\r\n\t\tthis.setMediaStreamConstraints({ video, audio })\r\n\t\t\t.setMediaRecorderOptions(options)\r\n\t\t\t.setTimeSlice(option?.timeSlice);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetTimeSlice(timeSlice: number) {\r\n\t\ttimeSlice && (this.timeSlice = timeSlice);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetTimeSlice() {\r\n\t\treturn this.timeSlice;\r\n\t}\r\n\r\n\tgetMediaType() {\r\n\t\treturn this.mediaType;\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param setMediaType \r\n\t * audio: 录音 Boolean;\r\n\t\tvideo: 录像 Boolean;\r\n\t\tscreen: 录屏 Boolean;\r\n\t * @returns \r\n\t */\r\n\tsetMediaType(mediaType: MediaType) {\r\n\t\tthis.mediaType = mediaType;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetMedisStream(): MediaStream | null {\r\n\t\treturn this.mediaStream;\r\n\t}\r\n\r\n\tasync setMediaStream(constraints?: MediaStreamConstraints) {\r\n\t\tthis.setMediaStreamConstraints(constraints);\r\n\t\tconst _constraints = this.getMediaStreamConstraints();\r\n\t\tconst mediaType = this.getMediaType();\r\n\t\tthis.setMediaState(\"wait\");\r\n\t\ttry {\r\n\t\t\tthis.mediaStream =\r\n\t\t\t\tmediaType === \"screen\"\r\n\t\t\t\t\t? await navigator.mediaDevices.getDisplayMedia(_constraints)\r\n\t\t\t\t\t: await navigator.mediaDevices.getUserMedia(_constraints);\r\n\t\t\tthis.setMediaState(\"ready\");\r\n\t\t\tthis.setSoundMeter();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.setMediaState(\"inactive\");\r\n\t\t\tthis.emit(\"error\", { type: \"setMedisStream\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tgetMediaRecorder(): MediaRecorder | null {\r\n\t\treturn this.mediaRecorder;\r\n\t}\r\n\r\n\tsetMediaRecorder(options?: MediaRecorderOptions) {\r\n\t\tthis.setMediaRecorderOptions(options);\r\n\t\tthis.mediaRecorder = new MediaRecorder(\r\n\t\t\tthis.mediaStream,\r\n\t\t\tthis.getMediaRecorderOptions(),\r\n\t\t);\r\n\r\n\t\tthis.mediaRecorder.onerror = (err: any) => {\r\n\t\t\tthis.emit(\"error\", { type: \"mediaRecorder\", message: err });\r\n\t\t};\r\n\r\n\t\t// 将 stream 转成 blob 来存放\r\n\t\tthis.mediaRecorder.ondataavailable = (blobEvent: BlobEvent) => {\r\n\t\t\tthis.emit(\"dataavailable\", blobEvent);\r\n\t\t\tthis.mediaBlobs.push(blobEvent.data);\r\n\t\t};\r\n\r\n\t\tthis.mediaRecorder.onstart = (event: any) => {\r\n\t\t\tthis.mediaBlobs = [];\r\n\t\t\tthis.emit(\"start\", event);\r\n\t\t};\r\n\r\n\t\tthis.mediaRecorder.onstop = (event: any) => {\r\n\t\t\tthis.soundMeter.stop();\r\n\t\t\tthis.emit(\"stop\", event);\r\n\t\t};\r\n\r\n\t\tthis.mediaRecorder.onpause = (event: any) => {\r\n\t\t\tthis.emit(\"pause\", event);\r\n\t\t};\r\n\r\n\t\tthis.mediaRecorder.onresume = (event: any) => {\r\n\t\t\tthis.emit(\"resume\", event);\r\n\t\t};\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetMediaBlobs(): Blob[] {\r\n\t\treturn this.mediaBlobs;\r\n\t}\r\n\r\n\tgetMediaState(): MediaState {\r\n\t\treturn this.mediaState;\r\n\t}\r\n\r\n\tprivate setMediaState(mediaState: MediaState) {\r\n\t\tthis.mediaState = mediaState;\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// type RecordingState = \"inactive\" | \"paused\" | \"recording\";\r\n\tgetRecorderState(): string {\r\n\t\treturn this.getMediaRecorder()?.state || \"inactive\";\r\n\t}\r\n\r\n\tgetMediaStreamConstraints(): MediaStreamConstraints | null {\r\n\t\treturn this.mediaStreamConstraints;\r\n\t}\r\n\r\n\t/**\r\n     *  \r\n     * @param constraints \r\n     * audio：指定是否获取音频流。\r\n        video：指定是否获取视频流。\r\n        audioConstraints 和 videoConstraints：分别指定音频和视频的约束条件，例如采样率、帧速率等。\r\n        facingMode：指定使用前置或后置摄像头。\r\n        width 和 height：指定视频的宽度和高度。\r\n        frameRate：指定视频的帧速率。\r\n        deviceId：指定要使用的音频或视频设备的 ID。\r\n     * @returns \r\n     */\r\n\tsetMediaStreamConstraints(constraints?: MediaStreamConstraints) {\r\n\t\tconst _constraints = {\r\n\t\t\t...this.getMediaStreamConstraints(),\r\n\t\t\t...constraints,\r\n\t\t};\r\n\t\tthis.mediaStreamConstraints = _constraints;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetMediaRecorderOptions(): MediaRecorderOptions | null {\r\n\t\treturn this.mediaRecorderOptions;\r\n\t}\r\n\r\n\t/**\r\n     * \r\n     * @param options \r\n     * mimeType：指定录制的媒体文件类型，例如 audio/webm、video/webm 等。\r\n        audioBitsPerSecond 和 videoBitsPerSecond：分别指定音频和视频的比特率。\r\n        audioChannels：指定使用的音频通道数。\r\n        videoFrameRate：指定视频的帧速率。\r\n        width 和 height：指定视频的宽度和高度。\r\n        videoSize：指定视频的大小，可以是宽度和高度组成的对象，也可以是字符串（例如“640x480”）。\r\n        echoCancellation：指定是否启用回声消除。\r\n     * @returns \r\n     */\r\n\tsetMediaRecorderOptions(options?: MediaRecorderOptions) {\r\n\t\tconst _options = { ...this.getMediaRecorderOptions(), ...options };\r\n\t\tthis.mediaRecorderOptions = _options;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tisReady(type: string = \"isReady\"): boolean {\r\n\t\tconst mediaState = this.getMediaState();\r\n\t\tif (mediaState === \"ready\") {\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\tconst err = `the cureent mediaState is ${mediaState}, Please use open function`;\r\n\t\t\tthis.emit(\"error\", { type, message: err });\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tonerror(callback?: Function) {\r\n\t\tcallback && this.on(\"error\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// 创建\r\n\tasync create() {\r\n\t\tif (this.getMediaState() === \"inactive\") {\r\n\t\t\tconst media = await this.setMediaStream();\r\n\t\t\tif (media) {\r\n\t\t\t\tthis.setMediaRecorder();\r\n\t\t\t\tthis.emit(\"create\");\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\tthis.emit(\"error\", {\r\n\t\t\t\ttype: \"create\",\r\n\t\t\t\tmessage: `mediaState: ${this.getMediaState()}`,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\toncreate(callback?: Function) {\r\n\t\tcallback && this.on(\"create\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// 销毁\r\n\tdestroy() {\r\n\t\tif (this.getMediaState() !== \"inactive\") {\r\n\t\t\tthis.getRecorderState() !== \"inactive\" && this.stop();\r\n\t\t\tthis.mediaStream?.getTracks().forEach((track) => track.stop());\r\n\t\t\tthis.mediaBlobs = [];\r\n\t\t\tthis.mediaStream = null;\r\n\t\t\tthis.mediaRecorder = null;\r\n\t\t\tthis.setMediaState(\"inactive\");\r\n\t\t\tthis.emit(\"destroy\");\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\tthis.emit(\"error\", {\r\n\t\t\t\ttype: \"destroy\",\r\n\t\t\t\tmessage: `mediaState: ${this.getMediaState()}`,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tondestroy(callback?: Function) {\r\n\t\tcallback && this.on(\"destroy\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tondataavailable(callback?: Function) {\r\n\t\tcallback && this.on(\"dataavailable\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// 开始\r\n\tstart(timeSlice?: number) {\r\n\t\tif (!this.isReady()) return this;\r\n\t\ttry {\r\n\t\t\tthis.setTimeSlice(timeSlice);\r\n\t\t\ttimeSlice = this.getTimeSlice();\r\n\t\t\ttimeSlice\r\n\t\t\t\t? this.mediaRecorder?.start(timeSlice)\r\n\t\t\t\t: this.mediaRecorder?.start();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"start\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tonstart(callback?: Function) {\r\n\t\tcallback && this.on(\"start\", callback);\r\n\t}\r\n\r\n\tstop() {\r\n\t\tif (!this.isReady()) return this;\r\n\t\ttry {\r\n\t\t\tthis.mediaRecorder?.stop();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"stop\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tonstop(callback?: Function) {\r\n\t\tcallback && this.on(\"stop\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// 暂停\r\n\tpause() {\r\n\t\tif (!this.isReady()) return this;\r\n\t\ttry {\r\n\t\t\tthis.mediaRecorder?.pause();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"pause\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tonpause(callback?: Function) {\r\n\t\tcallback && this.on(\"pause\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// 继续\r\n\tresume() {\r\n\t\tif (!this.isReady()) return this;\r\n\t\ttry {\r\n\t\t\tthis.mediaRecorder?.resume();\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"resume\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tonresume(callback?: Function) {\r\n\t\tcallback && this.on(\"resume\", callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetSoundMeter(mediaStream?: MediaStream) {\r\n\t\ttry {\r\n\t\t\tconst audioContext = new AudioContext();\r\n\t\t\tthis.soundMeter = new SoundMeter(audioContext);\r\n\t\t\tthis.soundMeter.connectToSource(mediaStream || this.mediaStream);\r\n\t\t\treturn this;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"setSoundMeter\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tgetSoundMeter(): SoundMeter {\r\n\t\treturn this.soundMeter;\r\n\t}\r\n\r\n\tgetBlob(options?: BlobPropertyBag): Blob {\r\n\t\tif (!this.isReady()) return;\r\n\t\tconst { mimeType } = this.getMediaRecorderOptions();\r\n\t\tif (!options) {\r\n\t\t\toptions = {\r\n\t\t\t\ttype: mimeType,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst blob = new Blob(this.mediaBlobs, options);\r\n\t\treturn blob;\r\n\t}\r\n\r\n\t// 获取BlobUrl\r\n\tgetBlobUrl(options?: BlobPropertyBag): string {\r\n\t\tif (!this.isReady()) return;\r\n\t\ttry {\r\n\t\t\tconst blob = this.getBlob(options);\r\n\t\t\tconst mediaUrl = URL.createObjectURL(blob);\r\n\t\t\treturn mediaUrl;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"getBlobUrl\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tdownloadBlob(filename) {\r\n\t\tconst url = this.getBlobUrl();\r\n\t\tconst a = document.createElement(\"a\");\r\n\t\ta.style.display = \"none\";\r\n\t\ta.href = url;\r\n\t\ta.download = `${filename || \"mediajs\"}.webm`;\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.click();\r\n\t\tsetTimeout(() => {\r\n\t\t\tdocument.body.removeChild(a);\r\n\t\t\twindow.URL.revokeObjectURL(url);\r\n\t\t}, 150);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// 获取时长\r\n\tgetDuration(blob?: Blob): Promise<number> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tblob = blob || this.getBlob();\r\n\r\n\t\t\tconst _this = this;\r\n\t\t\tconst audioContext = new AudioContext();\r\n\t\t\tconst reader = new FileReader();\r\n\r\n\t\t\treader.onload = function () {\r\n\t\t\t\tconst arrayBuffer = this.result as ArrayBuffer;\r\n\t\t\t\taudioContext.decodeAudioData(\r\n\t\t\t\t\tarrayBuffer,\r\n\t\t\t\t\t(buffer) => {\r\n\t\t\t\t\t\tconst duration = Math.round(buffer.duration * 1000);\r\n\t\t\t\t\t\tresolve(duration);\r\n\t\t\t\t\t},\r\n\t\t\t\t\t(err) => {\r\n\t\t\t\t\t\t_this.emit(\"error\", \"getDuration\", `getDuration function is err`);\r\n\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t},\r\n\t\t\t\t);\r\n\t\t\t};\r\n\r\n\t\t\tif (blob) {\r\n\t\t\t\treader.readAsArrayBuffer(blob);\r\n\t\t\t} else {\r\n\t\t\t\t_this.emit(\"error\", \"getDuration\", `blob is Empty`);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tasync _enumerateDevices() {\r\n\t\ttry {\r\n\t\t\tconst devices = await navigator.mediaDevices.enumerateDevices();\r\n\t\t\treturn devices;\r\n\t\t} catch (err) {\r\n\t\t\tthis.emit(\"error\", { type: \"_enumerateDevices\", message: err });\r\n\t\t}\r\n\t}\r\n\r\n\tgetSupportedMimeTypes(): string[] {\r\n\t\tconst media = this.mediaType === \"audio\" ? \"audio\" : \"video\";\r\n\t\tconst types = [\r\n\t\t\t\"webm\",\r\n\t\t\t\"mp4\",\r\n\t\t\t\"ogg\",\r\n\t\t\t\"mov\",\r\n\t\t\t\"avi\",\r\n\t\t\t\"wmv\",\r\n\t\t\t\"flv\",\r\n\t\t\t\"mkv\",\r\n\t\t\t\"ts\",\r\n\t\t\t\"x-matroska\",\r\n\t\t];\r\n\t\tconst codecs = [\r\n\t\t\t\"vp9\",\r\n\t\t\t\"vp9.0\",\r\n\t\t\t\"vp8\",\r\n\t\t\t\"vp8.0\",\r\n\t\t\t\"avc1\",\r\n\t\t\t\"av1\",\r\n\t\t\t\"h265\",\r\n\t\t\t\"h264\",\r\n\t\t];\r\n\t\tconst supported: string[] = [];\r\n\t\tconst isSupported = MediaRecorder.isTypeSupported;\r\n\t\ttypes.forEach((type: string) => {\r\n\t\t\tconst mimeType = `${media}/${type}`;\r\n\t\t\tcodecs.forEach((codec: string) =>\r\n\t\t\t\t[\r\n\t\t\t\t\t`${mimeType};codecs=${codec}`,\r\n\t\t\t\t\t`${mimeType};codecs=${codec.toUpperCase()}`,\r\n\t\t\t\t].forEach((variation) => {\r\n\t\t\t\t\tif (isSupported(variation)) supported.push(variation);\r\n\t\t\t\t}),\r\n\t\t\t);\r\n\t\t\tif (isSupported(mimeType)) supported.push(mimeType);\r\n\t\t});\r\n\t\treturn supported;\r\n\t}\r\n\r\n\t_isTypeSupported(mimeType: string): boolean {\r\n\t\treturn MediaRecorder.isTypeSupported(mimeType);\r\n\t}\r\n\r\n\tgetVideoTracks(stream?: MediaStream): MediaStreamTrack[] {\r\n\t\tstream = stream || this.mediaStream;\r\n\t\treturn stream.getVideoTracks();\r\n\t}\r\n\r\n\tconnectVideo(video: HTMLVideoElement) {\r\n\t\tvideo.srcObject = this.mediaStream;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tconnectAudio(audio: HTMLAudioElement) {\r\n\t\taudio.srcObject = this.mediaStream;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsnapshot(canvas: HTMLCanvasElement, video: HTMLVideoElement) {\r\n\t\tcanvas.width = video.videoWidth;\r\n\t\tcanvas.height = video.videoHeight;\r\n\t\tcanvas.getContext(\"2d\").drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\t\treturn this;\r\n\t}\r\n}\r\n\r\nexport { Media };\r\n\r\nexport default Media;\r\n","type EventType =\r\n\t| \"error\"\r\n\t| \"create\"\r\n\t| \"destroy\"\r\n\t| \"start\"\r\n\t| \"stop\"\r\n\t| \"pause\"\r\n\t| \"resume\"\r\n\t| \"dataavailable\";\r\n\r\nclass EventTarget {\r\n\tprivate eventBus: Record<EventType, Function[]> = {\r\n\t\terror: [],\r\n\t\tcreate: [],\r\n\t\tdestroy: [],\r\n\t\tstart: [],\r\n\t\tstop: [],\r\n\t\tpause: [],\r\n\t\tresume: [],\r\n\t\tdataavailable: [],\r\n\t};\r\n\r\n\t// 注册\r\n\ton(name: EventType, callback: Function) {\r\n\t\tconst callbackList: Array<Function> = this.eventBus[name] || [];\r\n\t\tcallbackList.push(callback);\r\n\t\tthis.eventBus[name] = callbackList;\r\n\t}\r\n\r\n\t// 触发\r\n\temit(name: EventType, ...args: Array<any>) {\r\n\t\tconst evnetName = this.eventBus[name];\r\n\t\tif (evnetName) {\r\n\t\t\tevnetName.forEach((fn) => {\r\n\t\t\t\tfn.apply(this, args);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.error(`emit ${name} is not find`);\r\n\t\t}\r\n\t}\r\n\r\n\t// 删除\r\n\toff(name: EventType, fn: Function) {\r\n\t\tconst evnetName = this.eventBus[name];\r\n\t\tif (evnetName && fn) {\r\n\t\t\tconst index = evnetName.findIndex((fns) => fns === fn);\r\n\t\t\tevnetName.splice(index, 1);\r\n\t\t} else {\r\n\t\t\tconsole.error(`off ${name} is not find`);\r\n\t\t}\r\n\t}\r\n\r\n\t// 注册一次\r\n\tonce(name: EventType, fn: Function) {\r\n\t\tconst decor = (...args: Array<any>) => {\r\n\t\t\tfn.apply(this, args);\r\n\t\t\tthis.off(name, decor);\r\n\t\t};\r\n\t\tthis.on(name, decor);\r\n\t}\r\n}\r\n\r\nexport default EventTarget;\r\n","class SoundMeter {\r\n\tprivate context: AudioContext;\r\n\tprivate instant: number = 0.0;\r\n\tprivate slow: number = 0.0;\r\n\tprivate clip: number = 0.0;\r\n\tprivate script: ScriptProcessorNode;\r\n\tprivate mic: MediaStreamAudioSourceNode;\r\n\r\n\tconstructor(context: AudioContext) {\r\n\t\tthis.context = context;\r\n\t\tthis.script = context.createScriptProcessor(2048, 1, 1);\r\n\t\tthis.script.onaudioprocess = (event) => {\r\n\t\t\tconst input = event.inputBuffer.getChannelData(0);\r\n\t\t\tlet i;\r\n\t\t\tlet sum = 0.0;\r\n\t\t\tlet clipcount = 0;\r\n\t\t\tfor (i = 0; i < input.length; ++i) {\r\n\t\t\t\tsum += input[i] * input[i];\r\n\t\t\t\tif (Math.abs(input[i]) > 0.99) {\r\n\t\t\t\t\tclipcount += 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.instant = Math.sqrt(sum / input.length);\r\n\t\t\tthis.slow = 0.95 * this.slow + 0.05 * this.instant;\r\n\t\t\tthis.clip = clipcount / input.length;\r\n\t\t};\r\n\t}\r\n\r\n\tgetInstant() {\r\n\t\treturn this.instant;\r\n\t}\r\n\r\n\tgetSlow() {\r\n\t\treturn this.slow;\r\n\t}\r\n\r\n\tgetClip() {\r\n\t\treturn this.clip;\r\n\t}\r\n\r\n\tconnectToSource(stream: MediaStream) {\r\n\t\ttry {\r\n\t\t\tthis.mic = this.context.createMediaStreamSource(stream);\r\n\t\t\tthis.mic.connect(this.script);\r\n\t\t\tthis.script.connect(this.context.destination);\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(e);\r\n\t\t}\r\n\t}\r\n\r\n\tstop() {\r\n\t\tthis.mic.disconnect();\r\n\t\tthis.script.disconnect();\r\n\t}\r\n}\r\n\r\nexport { SoundMeter };\r\n\r\nexport default SoundMeter;\r\n","import webRTCAdapter_import from \"webrtc-adapter\";\r\n\r\nconst webRTCAdapter: typeof webRTCAdapter_import =\r\n\t//@ts-ignore\r\n\twebRTCAdapter_import.default || webRTCAdapter_import;\r\n\r\nexport const Env = new (class {\r\n\treadonly isIOS = [\"iPad\", \"iPhone\", \"iPod\"].includes(navigator.platform);\r\n\treadonly supportedBrowsers = [\"firefox\", \"chrome\", \"safari\"];\r\n\r\n\treadonly minFirefoxVersion = 59;\r\n\treadonly minChromeVersion = 72;\r\n\treadonly minSafariVersion = 605;\r\n\r\n\tisAudioContextSupported(): boolean {\r\n\t\treturn typeof AudioContext !== \"undefined\";\r\n\t}\r\n\r\n\tisMediaDevicesSupported(): boolean {\r\n\t\treturn typeof navigator.mediaDevices !== \"undefined\";\r\n\t}\r\n\r\n\tisGetUserMediaSupported(): boolean {\r\n\t\treturn (\r\n\t\t\tthis.isMediaDevicesSupported() &&\r\n\t\t\ttypeof navigator.mediaDevices.getUserMedia !== \"undefined\"\r\n\t\t);\r\n\t}\r\n\r\n\tisMediaRecorderSupported(): boolean {\r\n\t\treturn typeof MediaRecorder !== \"undefined\";\r\n\t}\r\n\r\n\tisAudioWorkletNode(): boolean {\r\n\t\treturn typeof AudioWorkletNode !== \"undefined\";\r\n\t}\r\n\r\n\tisBrowserSupported(): boolean {\r\n\t\tconst browser = this.getBrowser();\r\n\t\tconst version = this.getVersion();\r\n\r\n\t\tconst validBrowser = this.supportedBrowsers.includes(browser);\r\n\r\n\t\tif (!validBrowser) return false;\r\n\r\n\t\tif (browser === \"chrome\") return version >= this.minChromeVersion;\r\n\t\tif (browser === \"firefox\") return version >= this.minFirefoxVersion;\r\n\t\tif (browser === \"safari\")\r\n\t\t\treturn !this.isIOS && version >= this.minSafariVersion;\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetBrowser(): string {\r\n\t\treturn webRTCAdapter.browserDetails.browser;\r\n\t}\r\n\r\n\tgetVersion(): number {\r\n\t\treturn webRTCAdapter.browserDetails.version || 0;\r\n\t}\r\n\r\n\tisUnifiedPlanSupported(): boolean {\r\n\t\tconst browser = this.getBrowser();\r\n\t\tconst version = webRTCAdapter.browserDetails.version || 0;\r\n\r\n\t\tif (browser === \"chrome\" && version < this.minChromeVersion) return false;\r\n\t\tif (browser === \"firefox\" && version >= this.minFirefoxVersion) return true;\r\n\t\tif (\r\n\t\t\t!(\r\n\t\t\t\tthis.isAudioContextSupported() &&\r\n\t\t\t\tthis.isMediaDevicesSupported() &&\r\n\t\t\t\tthis.isGetUserMediaSupported() &&\r\n\t\t\t\tthis.isMediaRecorderSupported() &&\r\n\t\t\t\tthis.isAudioWorkletNode()\r\n\t\t\t)\r\n\t\t)\r\n\t\t\treturn false;\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\ttoString(): string {\r\n\t\treturn `Supports:\r\n    browser:${this.getBrowser()}\r\n    version:${this.getVersion()}\r\n    isIOS:${this.isIOS}\r\n    isAudioContextSupported:${this.isAudioContextSupported()}\r\n\tisMediaDevicesSupported:${this.isMediaDevicesSupported()}\r\n\tisGetUserMediaSupported:${this.isGetUserMediaSupported()}\r\n\tisMediaRecorderSupported:${this.isMediaRecorderSupported()}\r\n    isBrowserSupported:${this.isBrowserSupported()}\r\n\tisAudioWorkletNode:${this.isAudioWorkletNode()}\r\n    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}\r\n\t`;\r\n\t}\r\n})();\r\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n// Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\nimport * as sdp from 'sdp';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings,\n    // Expose sdp as a convenience. For production apps include directly.\n    sdp,\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n    'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n      /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n      /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n      /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n","export default function _typeof(obj) {\n    \"@swc/helpers - typeof\";\n    return obj && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n    .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n        this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n        externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n        internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n        .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n    window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n    'localDescription', {\n      get() {\n        const description = origLocalDescription.get.apply(this);\n        if (description.type === '') {\n          return description;\n        }\n        return replaceInternalStreamId(this, description);\n      }\n    });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n          'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","import arrayWithHoles from './_array_with_holes.mjs';\nimport iterableToArrayLimit from './_iterable_to_array.mjs';\nimport nonIterableRest from './_non_iterable_rest.mjs';\nimport unsupportedIterableToArray from './_unsupported_iterable_to_array.mjs';\n\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n","import _arrayLikeToArray from './_array_like_to_array.mjs';\n\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))\n    return _arrayLikeToArray(o, minLen);\n}\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n            .then(devices => {\n              devices = devices.filter(d => d.kind === 'videoinput');\n              let dev = devices.find(d => matches.some(match =>\n                d.label.toLowerCase().includes(match)));\n              if (!dev && devices.length && matches.includes('back')) {\n                dev = devices[devices.length - 1]; // more likely the back cam\n              }\n              if (dev) {\n                constraints.video.deviceId = face.exact\n                  ? {exact: dev.deviceId}\n                  : {ideal: dev.deviceId};\n              }\n              constraints.video = constraintsToChrome_(constraints.video);\n              logging('chrome: ' + JSON.stringify(constraints));\n              return func(constraints);\n            });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n      Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        // WebIDL input coercion and validation\n        let sendEncodings = arguments[1] && arguments[1].sendEncodings;\n        if (sendEncodings === undefined) {\n          sendEncodings = [];\n        }\n        sendEncodings = [...sendEncodings];\n        const shouldPerformCheck = sendEncodings.length > 0;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = sendEncodings;\n            sender.sendEncodings = sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateOffer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateAnswer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","import arrayWithoutHoles from './_array_without_holes.mjs';\nimport iterableToArray from './_iterable_to_array.mjs';\nimport nonIterableSpread from './_non_iterable_spread.mjs';\nimport unsupportedIterableToArray from './_unsupported_iterable_to_array.mjs';\n\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n","import _arrayLikeToArray from './_array_like_to_array.mjs';\n\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n      'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n        .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (server.urls === undefined && server.url) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio', {direction: 'recvonly'});\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video', {direction: 'recvonly'});\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substring(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      const augmentedCandidate = Object.assign(nativeCandidate,\n        parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function toJSON() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment,\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimRTCIceCandidateRelayProtocol(window) {\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'relayProtocol' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      const parsedCandidate = SDPUtils.parseCandidate(e.candidate.candidate);\n      if (parsedCandidate.type === 'relay') {\n        // This is a libwebrtc-specific mapping of local type preference\n        // to relayProtocol.\n        e.candidate.relayProtocol = {\n          0: 'tls',\n          1: 'tcp',\n          2: 'udp',\n        }[parsedCandidate.priority >> 24];\n      }\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substring(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n          this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n          this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n\n// Note: Make sure to call this ahead of APIs that modify\n// setLocalDescription.length\nexport function shimParameterlessSetLocalDescription(window, browserDetails) {\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  if (!nativeSetLocalDescription || nativeSetLocalDescription.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      let desc = arguments[0] || {};\n      if (typeof desc !== 'object' || (desc.type && desc.sdp)) {\n        return nativeSetLocalDescription.apply(this, arguments);\n      }\n      // The remaining steps should technically happen when SLD comes off the\n      // RTCPeerConnection's operations chain (not ahead of going on it), but\n      // this is too difficult to shim. Instead, this shim only covers the\n      // common case where the operations chain is empty. This is imperfect, but\n      // should cover many cases. Rationale: Even if we can't reduce the glare\n      // window to zero on imperfect implementations, there's value in tapping\n      // into the perfect negotiation pattern that several browsers support.\n      desc = {type: desc.type, sdp: desc.sdp};\n      if (!desc.type) {\n        switch (this.signalingState) {\n          case 'stable':\n          case 'have-local-offer':\n          case 'have-remote-pranswer':\n            desc.type = 'offer';\n            break;\n          default:\n            desc.type = 'answer';\n            break;\n        }\n      }\n      if (desc.sdp || (desc.type !== 'offer' && desc.type !== 'answer')) {\n        return nativeSetLocalDescription.apply(this, [desc]);\n      }\n      const func = desc.type === 'offer' ? this.createOffer : this.createAnswer;\n      return func.apply(this)\n        .then(d => nativeSetLocalDescription.apply(this, [d]));\n    };\n}\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nconst SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substring(2, 12);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(line => line.trim());\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  const parts = blob.split('\\nm=');\n  return parts.map((part, index) => (index > 0 ?\n    'm=' + part : part).trim() + '\\r\\n');\n};\n\n// Returns the session description.\nSDPUtils.getDescription = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// Returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(line => line.indexOf(prefix) === 0);\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\n// Input can be prefixed with a=.\nSDPUtils.parseCandidate = function(line) {\n  let parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  const candidate = {\n    foundation: parts[0],\n    component: {1: 'rtp', 2: 'rtcp'}[parts[1]] || parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7],\n  };\n\n  for (let i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compatibility.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag. Don't overwrite.\n        if (candidate[parts[i]] === undefined) {\n          candidate[parts[i]] = parts[i + 1];\n        }\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\n// This does not include the a= prefix!\nSDPUtils.writeCandidate = function(candidate) {\n  const sdp = [];\n  sdp.push(candidate.foundation);\n\n  const component = candidate.component;\n  if (component === 'rtp') {\n    sdp.push(1);\n  } else if (component === 'rtcp') {\n    sdp.push(2);\n  } else {\n    sdp.push(component);\n  }\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  const type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// Sample input:\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substring(14).split(' ');\n};\n\n// Parses a rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  let parts = line.substring(9).split(' ');\n  const parsed = {\n    payloadType: parseInt(parts.shift(), 10), // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generates a rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  const channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses a extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1],\n    attributes: parts.slice(2).join(' '),\n  };\n};\n\n// Generates an extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri +\n      (headerExtension.attributes ? ' ' + headerExtension.attributes : '') +\n      '\\r\\n';\n};\n\n// Parses a fmtp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  const parsed = {};\n  let kv;\n  const parts = line.substring(line.indexOf(' ') + 1).split(';');\n  for (let j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates a fmtp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  let line = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    const params = [];\n    Object.keys(codec.parameters).forEach(param => {\n      if (codec.parameters[param] !== undefined) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses a rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  const parts = line.substring(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' '),\n  };\n};\n\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  let lines = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(fb => {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses a RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  const sp = line.indexOf(' ');\n  const parts = {\n    ssrc: parseInt(line.substring(7, sp), 10),\n  };\n  const colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substring(sp + 1, colon);\n    parts.value = line.substring(colon + 1);\n  } else {\n    parts.attribute = line.substring(sp + 1);\n  }\n  return parts;\n};\n\n// Parse a ssrc-group line (see RFC 5576). Sample input:\n// a=ssrc-group:semantics 12 34\nSDPUtils.parseSsrcGroup = function(line) {\n  const parts = line.substring(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(ssrc => parseInt(ssrc, 10)),\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// Returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  const mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substring(6);\n  }\n};\n\n// Parses a fingerprint line for DTLS-SRTP.\nSDPUtils.parseFingerprint = function(line) {\n  const parts = line.substring(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1].toUpperCase(), // the definition is upper-case in RFC 4572.\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint),\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  let sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(fp => {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  const parts = keyParams.substring(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES parameters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  const ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  const pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substring(12),\n    password: pwd.substring(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  let sdp = 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n  if (params.iceLite) {\n    sdp += 'a=ice-lite\\r\\n';\n  }\n  return sdp;\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  const description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: [],\n  };\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  description.profile = mline[2];\n  for (let i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    const pt = mline[i];\n    const rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      const codec = SDPUtils.parseRtpMap(rtpmapline);\n      const fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(line => {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  const wildcardRtcpFb = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:* ')\n    .map(SDPUtils.parseRtcpFb);\n  description.codecs.forEach(codec => {\n    wildcardRtcpFb.forEach(fb=> {\n      const duplicate = codec.rtcpFeedback.find(existingFeedback => {\n        return existingFeedback.type === fb.type &&\n          existingFeedback.parameter === fb.parameter;\n      });\n      if (!duplicate) {\n        codec.rtcpFeedback.push(fb);\n      }\n    });\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  let sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' ' + (caps.profile || 'UDP/TLS/RTP/SAVPF') + ' ';\n  sdp += caps.codecs.map(codec => {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(codec => {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  let maxptime = 0;\n  caps.codecs.forEach(codec => {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(extension => {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  const encodingParameters = [];\n  const description = SDPUtils.parseRtpParameters(mediaSection);\n  const hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  const hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  const ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(parts => parts.attribute === 'cname');\n  const primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  let secondarySsrc;\n\n  const flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(line => {\n      const parts = line.substring(17).split(' ');\n      return parts.map(part => parseInt(part, 10));\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(codec => {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      let encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red',\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc,\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  let bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substring(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substring(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(params => {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  const rtcpParameters = {};\n\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  const remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(obj => obj.attribute === 'cname')[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  const rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  const mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\nSDPUtils.writeRtcpParameters = function(rtcpParameters) {\n  let sdp = '';\n  if (rtcpParameters.reducedSize) {\n    sdp += 'a=rtcp-rsize\\r\\n';\n  }\n  if (rtcpParameters.mux) {\n    sdp += 'a=rtcp-mux\\r\\n';\n  }\n  if (rtcpParameters.ssrc !== undefined && rtcpParameters.cname) {\n    sdp += 'a=ssrc:' + rtcpParameters.ssrc +\n      ' cname:' + rtcpParameters.cname + '\\r\\n';\n  }\n  return sdp;\n};\n\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  let parts;\n  const spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substring(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  const planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(msidParts => msidParts.attribute === 'msid');\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  const mline = SDPUtils.parseMLine(mediaSection);\n  const maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  let maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substring(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  const sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substring(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize,\n    };\n  }\n  const sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    const parts = sctpMapLines[0]\n      .substring(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize,\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  let output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n',\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n',\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 22);\n};\n\n// Write boiler plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  let sessionId;\n  const version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  const user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  const lines = SDPUtils.splitLines(mediaSection);\n  for (let i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substring(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  return mline[0].substring(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const parts = lines[0].substring(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' '),\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  const line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  const parts = line.substring(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5],\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  const lines = SDPUtils.splitLines(blob);\n  for (let i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","{\r\n\t\"name\": \"mediajs\",\r\n\t\"version\": \"1.0.0\",\r\n\t\"keywords\": [\r\n\t\t\"mediajs\",\r\n\t\t\"webrtc\",\r\n\t\t\"adapter\",\r\n\t\t\"audio\",\r\n\t\t\"video\",\r\n\t\t\"screen\"\r\n\t],\r\n\t\"description\": \"MediaJS is a JavaScript library that can record audio, video and screen \",\r\n\t\"homepage\": \"https://mediajs.com\",\r\n\t\"bugs\": {\r\n\t\t\"url\": \"https://github.com/027xiguapi/mediajs/issues\"\r\n\t},\r\n\t\"repository\": {\r\n\t\t\"type\": \"git\",\r\n\t\t\"url\": \"https://github.com/027xiguapi/mediajs\"\r\n\t},\r\n\t\"license\": \"MIT\",\r\n\t\"contributors\": [\r\n\t\t\"027xiguapi <458813868@qq.com>\"\r\n\t],\r\n\t\"files\": [\r\n\t\t\"dist/*\"\r\n\t],\r\n\t\"sideEffects\": [\r\n\t\t\"src/global.ts\",\r\n\t\t\"src/supports.ts\"\r\n\t],\r\n\t\"main\": \"dist/bundler.cjs\",\r\n\t\"module\": \"dist/bundler.mjs\",\r\n\t\"browser-minified\": \"dist/mediajs.global.min.js\",\r\n\t\"browser-unminified\": \"dist/mediajs.global.js\",\r\n\t\"types\": \"dist/types.d.ts\",\r\n\t\"engines\": {\r\n\t\t\"node\": \">= 18\"\r\n\t},\r\n\t\"targets\": {\r\n\t\t\"types\": {\r\n\t\t\t\"source\": \"src/exports.ts\"\r\n\t\t},\r\n\t\t\"main\": {\r\n\t\t\t\"source\": \"src/exports.ts\",\r\n\t\t\t\"sourceMap\": {\r\n\t\t\t\t\"inlineSources\": true\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"module\": {\r\n\t\t\t\"source\": \"src/exports.ts\",\r\n\t\t\t\"includeNodeModules\": [\r\n\t\t\t\t\"eventemitter3\"\r\n\t\t\t],\r\n\t\t\t\"sourceMap\": {\r\n\t\t\t\t\"inlineSources\": true\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"browser-minified\": {\r\n\t\t\t\"context\": \"browser\",\r\n\t\t\t\"outputFormat\": \"global\",\r\n\t\t\t\"optimize\": true,\r\n\t\t\t\"engines\": {\r\n\t\t\t\t\"browsers\": \"cover 99%, not dead\"\r\n\t\t\t},\r\n\t\t\t\"source\": \"src/global.ts\"\r\n\t\t},\r\n\t\t\"browser-unminified\": {\r\n\t\t\t\"context\": \"browser\",\r\n\t\t\t\"outputFormat\": \"global\",\r\n\t\t\t\"optimize\": false,\r\n\t\t\t\"engines\": {\r\n\t\t\t\t\"browsers\": \"cover 99%, not dead\"\r\n\t\t\t},\r\n\t\t\t\"source\": \"src/global.ts\"\r\n\t\t}\r\n\t},\r\n\t\"scripts\": {\r\n\t\t\"contributors\": \"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\\"chore(contributors): update and sort contributors list\\\"\",\r\n\t\t\"check\": \"tsc --noEmit\",\r\n\t\t\"watch\": \"parcel watch\",\r\n\t\t\"build\": \"rimraf dist && parcel build\",\r\n\t\t\"prepublishOnly\": \"npm run build\",\r\n\t\t\"format\": \"prettier --write .\",\r\n\t\t\"semantic-release\": \"semantic-release\",\r\n\t\t\"mocha\": \"mocha --timeout 5000 'examples/src/content/**/test.js'\"\r\n\t},\r\n\t\"devDependencies\": {\r\n\t\t\"@parcel/config-default\": \"^2.8.1\",\r\n\t\t\"@parcel/packager-ts\": \"^2.8.1\",\r\n\t\t\"@parcel/transformer-typescript-tsc\": \"^2.8.1\",\r\n\t\t\"@parcel/transformer-typescript-types\": \"^2.8.1\",\r\n\t\t\"@semantic-release/changelog\": \"^6.0.1\",\r\n\t\t\"@semantic-release/git\": \"^10.0.1\",\r\n\t\t\"@swc/core\": \"^1.3.27\",\r\n\t\t\"chai\": \"^4.3.7\",\r\n\t\t\"mocha\": \"^10.2.0\",\r\n\t\t\"parcel\": \"^2.8.1\",\r\n\t\t\"parcel-transformer-tsc-sourcemaps\": \"^1.0.2\",\r\n\t\t\"prettier\": \"^2.6.2\",\r\n\t\t\"selenium-webdriver\": \"^4.8.2\",\r\n\t\t\"semantic-release\": \"^20.0.0\",\r\n\t\t\"typescript\": \"^4.5.5\"\r\n\t},\r\n\t\"dependencies\": {\r\n\t\t\"@swc/helpers\": \"^0.4.0\",\r\n\t\t\"webrtc-adapter\": \"^8.0.0\"\r\n\t}\r\n}"],"names":[],"version":3,"file":"mediajs.global.js.map"}